<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content=" Created by Evgenii Baiakhmetov " />


<title>Quality check and genome assembly using Illumina, ONT, HiFi, and Hi-C data</title>

<script src="index_files/header-attrs-2.24/header-attrs.js"></script>
<script src="index_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="index_files/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="index_files/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="index_files/tocify-1.9.1/jquery.tocify.js"></script>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<script src="index_files/clipboard-1.7.1/clipboard.min.js"></script>
<link href="index_files/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="index_files/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="index_files/klippy-0.0.0.9500/js/klippy.min.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>










<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">



<h1 class="title toc-ignore">Quality check and genome assembly using
Illumina, ONT, HiFi, and Hi-C data</h1>
<h4 class="author"><p class="text-right"><br />
<font size="1">Created by </font><a
href="https://www.researchgate.net/profile/Evgenii-Baiakhmetov"><font size="2">Evgenii
Baiakhmetov</font></a><br />
</p></h4>

</div>


<style>
/* Base Code Block Styling */
.code-header { /* Keep your existing header styles */ }
.copy-button { /* Keep your button styles */ }

/* Bash Syntax Coloring */
.code-text pre {
  color: #c9d1d9; /* Base text color */
  font-family: 'Fira Code', monospace;
}

.bash-keyword { color: #ff7b72; } /* Commands like 'if', 'for' */
.bash-string { color: #a5d6ff; }  /* Strings in quotes */
.bash-comment { color: #8b949e; } /* Comments */
.bash-function { color: #d2a8ff; } /* Function names */
.bash-variable { color: #79c0ff; } /* Variables like $VAR */
.bash-parameter { color: #c9d1d9; } /* Flags like --min-alignment */
.bash-operator { color: #ff7b72; }  /* &&, ||, |, etc. */

/* Line continuation highlighting */
.bash-line-continuation::before {
  content: "↳ ";
  color: #8b949e;
  margin-right: 5px;
}
</style>
<style type="text/css">
#TOC {
  color: black; 
}
</style>
<style>
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    background-color: #25a4be;
}
</style>
<script>
  addKlippy('left', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<style>
  /* Main header container - Uses CSS Grid for precise layout */
  .code-header {
    background-color: #50505A;    /* Dark gray background */
    color: white;                 /* Text color */
    display: grid;                /* Grid layout for columns */
    grid-template-columns: 1fr auto; /* Left/right column sizing */
    align-items: center;          /* Vertical centering for all items */
    padding: 0 15px;              /* Horizontal padding */
    height: 40px;                 /* Fixed height container */
    box-sizing: border-box;       /* Include padding in height calculation */
    border-radius: 10px 10px 0 0; /* Rounded top corners */
  }

  /* Text styling for OS name */
  .header-text {
    font: bold 14px/40px Arial, sans-serif; /* Font size/line-height matches container height */
    height: 100%;                 /* Full container height */
  }

  /* Copy button styling */
  .copy-button {
    background: #50505A;          /* Match header background */
    color: white;                 /* Text color */
    border: none;                 /* Remove default border */
    padding: 0 15px;              /* Horizontal padding */
    border-radius: 4px;           /* Rounded corners */
    font: 14px/34px Arial, sans-serif; /* Line-height calculation: 40px container - 2*3px margin */
    cursor: pointer;              /* Pointer cursor on hover */
    height: 34px;                 /* Calculated height: 40px container - 6px total margin */
    margin: 3px 0;                /* Vertical centering: (40-34)/2 = 3px */
    transition: background 0.2s;  /* Smooth hover effect */
  }

  /* Button hover state */
  .copy-button:hover {
    background: #50505A;          /* Lighten background on hover */
  }

  /* Code content section - Uses flexbox for vertical centering */
  .code-content {
    background: #181D28;          /* Dark background */
    color: white;                 /* Text color */
    padding: 15px;                /* Internal spacing */
    font-family: Monaco, monospace;/* Monospace font for code */
    border-radius: 0 0 10px 10px; /* Rounded bottom corners */
    min-height: 30px;            /* Minimum section height */
    display: flex;                /* Flexbox for centering */
    align-items: center;          /* Vertical centering */
    justify-content: flex-start;  /* Horizontal alignment (left) */
    box-sizing: border-box;       /* Include padding in height */
  }

  /* Content text styling */
  .code-text {
    width: 100%;                  /* Full width text container */
    word-break: break-all;        /* Handle long unbroken strings */
  }
    .code-text pre {
    margin: 0;                   /* Remove default <pre> margin */
    padding: 0;                  /* Remove default <pre> padding */
    background: transparent;     /* Inherit dark background */
    color: inherit;              /* Use parent's text color */
    border: none;                /* Remove borders */
    white-space: pre-wrap;       /* Allow wrapping but keep line breaks */
    font-family: inherit;        /* Use Monaco font from parent */
    line-height: 1.4;            /* Consistent line spacing */
  }
</style>
<div id="i-preface" class="section level1">
<h1>[I] Preface</h1>
<div id="in-a-nutshell" class="section level2">
<h2>In a nutshell</h2>
<span style="color:black">
<p class="text-justify">
This tutorial is, to some extent, a simplified version of <strong><a
href="https://niwdoog.github.io/Genome_Assembly_Long_Reads_Hi-C/">my
previous tutorial</a></strong> on chromosome-level scaffolding and
annotation of the diploid plant <em>Arabidopsis thaliana</em>
(2n=2x=10). In this version, I include a Quality Check (QC) assessment
step and employ an approach for identifying syntenic blocks commonly
used in comparative genomics. Additionally, I have downsized the dataset
to include only the smallest chromosome, Chr4 (ca. 22.2 Mbp), which
should reduce the overall time required to complete the analysis. The
tutorial is part of the workshop <strong><em>Introduction to
Bioinformatics and OMICs Data Analysis</em></strong>, conducted at XTBG
from February 10–14, 2025 (workshop leader: <strong><a
href="https://ylla-lab.github.io/">Dr Guillem Ylla</a></strong>).
</p>
<div class="alert alert-info"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> Please note that all data used here was
produced by <strong><a
href="https://doi.org/10.1016/j.gpb.2021.08.003">Wang B et al.,
2021</a></strong>. Additionally, please be aware that this tutorial does
not aim to reproduce all analyses from the aforementioned article in
detail. </span></p>
</div>
</div>
<div id="learning-outcomes" class="section level2">
<h2>Learning outcomes</h2>
<p><span style="color:black"> After completing this tutorial, you will
be able to:</p>
<ul>
<li><span style="color:black">perform a quality check of the raw
sequencing data.</span></li>
<li><span style="color:black">assemble a genome of interest using data
produced by second- and third-generation sequencing technologies,
including <a href="https://www.illumina.com/">Illumina</a>, <a
href="https://nanoporetech.com/">Oxford Nanopore Technologies (ONT)</a>,
and <a href="https://www.pacb.com/">Pacific Biosciences</a> Circular
Consensus Sequencing (<a
href="https://www.pacb.com/technology/hifi-sequencing/">CCS</a>)
reads.</span></li>
<li><span style="color:black">scaffold assembled contigs to the scale of
full chromosomes using a reference genome.</span></li>
<li><span style="color:black">scaffold assembled contigs to the scale of
full chromosomes using Hi-C data.</span></li>
<li><span style="color:black">identify, annotate and mask transposable
elements.</span></li>
<li><span style="color:black">annotate genomes using RNA-Seq and protein
homology information.</span></li>
<li><span style="color:black">visualise the results.</span></li>
</ul>
</div>
<div id="keywords" class="section level2">
<h2>Keywords</h2>
<span style="color:black">
<p class="text-justify">
Bioinformatics, Quality Check, ONT sequencing, HiFi sequencing, Illumina
sequencing, Hi-C sequencing, RNA sequencing, genome assembly, genome
annotation, Synteny, data visualisation.
</p>
</div>
</div>
<div id="ii-conda-sequencing-data" class="section level1">
<h1>[II] Conda &amp; sequencing data</h1>
<div id="conda-software-and-packages" class="section level2">
<h2>Conda, software, and packages</h2>
<div class="alert alert-danger"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <strong>IMPORTANT!</strong> Please refer
to <strong><a
href="https://niwdoog.github.io/Genome_Assembly_Long_Reads_Hi-C/">the
aforementioned tutorial</a></strong> on creating and setting up conda
environments, as well as package and software installation.
Additionally, you may consider switching to <strong><a
href="https://github.com/mamba-org/mamba">mamba</a></strong> over
conda.</p>
</div>
<p></span></p>
</div>
<div id="downloading-raw-sequence-data" class="section level2">
<h2>Downloading raw sequence data</h2>
<span style="color:black">
<p class="text-justify">
A subset of the Illumina, ONT, HiFi, and Hi-C reads was privately
provided to the workshop participants. The files are now available for
download through the <strong><a
href="https://doi.org/10.5281/zenodo.xyz">Zenodo
repository</a></strong>.
</p>
</div>
<div id="subsampling-workflow" class="section level2">
<h2>Subsampling workflow</h2>
<span style="color:black">
<p class="text-justify">
To reproduce all the steps for data subsampling while keeping only the
reads aligned to Chromosome 4, follow the steps below.
</p>
<div id="dataset" class="section level3">
<h3>[1] Dataset</h3>
<p class="text-justify">
First, create directories for Illumina, RNA-Seq, Hi-C, HiFi, and ONT
data:
</p>
<!-- Code -->
<div class="code-header">
<div class="header-text">
Bash
</div>
<p><button class="copy-button" onclick="copyText('code1')">Copy</button></p>
</div>
<div class="code-content">
<div id="code1" class="code-text">
<pre><span class="bash-keyword">mkdir</span> <span class="bash-string">Illumina RNAseq HiC HiFi ONT</span></pre>
</div>
</div>
</p>
<p class="text-justify">
Then, download the following files:
</p>
<p class="text-justify">
<ol style="list-style-type: decimal">
<li><strong>Illumina</strong> folder:
</p></li>
</ol>
<!-- Code -->
<div class="code-header">
<div class="header-text">
Bash
</div>
<p><button class="copy-button" onclick="copyText('code2')">Copy</button></p>
</div>
<div class="code-content">
<div id="code2" class="code-text">
<pre><span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">ftp://download.big.ac.cn/gsa/CRA004538/CRR302670/CRR302670_f1.fastq.gz</span> <span class="bash-operator">></span> <span class="bash-string">CRR302670_f1.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">ftp://download.big.ac.cn/gsa/CRA004538/CRR302670/CRR302670_r2.fastq.gz</span> <span class="bash-operator">></span> <span class="bash-string">CRR302670_r2.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span></pre>
</div>
</div>
</p>
<p class="text-justify">
<ol start="2" style="list-style-type: decimal">
<li><strong>RNAseq</strong> folder:
</p></li>
</ol>
<!-- Code -->
<div class="code-header">
<div class="header-text">
Bash
</div>
<p><button class="copy-button" onclick="copyText('code3')">Copy</button></p>
</div>
<div class="code-content">
<div id="code3" class="code-text">
<pre><span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR3581356/SRR3581356</span> <span class="bash-operator">></span> <span class="bash-string">wget_SRR3581356.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span> <span class="bash-comment"># root</span>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR3581693/SRR3581693</span> <span class="bash-operator">></span> <span class="bash-string">wget_SRR3581693.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span> <span class="bash-comment"># flower</span>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR3581681/SRR3581681</span> <span class="bash-operator">></span> <span class="bash-string">wget_SRR3581681.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span> <span class="bash-comment"># leaf</span>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR3581705/SRR3581705</span> <span class="bash-operator">></span> <span class="bash-string">wget_SRR3581705.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span> <span class="bash-comment"># internode</span>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR3581706/SRR3581706</span> <span class="bash-operator">></span> <span class="bash-string">wget_SRR3581706.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span> <span class="bash-comment"># seed</span>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR3581708/SRR3581708</span> <span class="bash-operator">></span> <span class="bash-string">wget_SRR3581708.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span> <span class="bash-comment"># silique</span>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">https://sra-pub-run-odp.s3.amazonaws.com/sra/SRR3581703/SRR3581703</span> <span class="bash-operator">></span> <span class="bash-string">wget_SRR3581703.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span> <span class="bash-comment"># pedicel</span></pre>
</div>
</div>
</p>
<p class="text-justify">
<ol start="3" style="list-style-type: decimal">
<li><strong>HiC</strong> folder:
</p></li>
</ol>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code4')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code4" class="code-text">
<pre>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">ftp://download.big.ac.cn/gsa/CRA004538/CRR302669/CRR302669_f1.fastq.gz</span> <span class="bash-operator">></span> <span class="bash-string">CRR302669_f1.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">ftp://download.big.ac.cn/gsa/CRA004538/CRR302669/CRR302669_r2.fastq.gz</span> <span class="bash-operator">></span> <span class="bash-string">CRR302669_r2.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span>
</pre>
</div>
</div>
</p>
<p class="text-justify">
<ol start="4" style="list-style-type: decimal">
<li><strong>HiFi</strong> folder:
</p></li>
</ol>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code5')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code5" class="code-text">
<pre>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">ftp://download.big.ac.cn/gsa/CRA004538/CRR302668/CRR302668.fastq.gz</span> <span class="bash-operator">></span> <span class="bash-string">CRR302668.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span>
</pre>
</div>
</div>
</p>
<p class="text-justify">
<ol start="5" style="list-style-type: decimal">
<li><strong>ONT</strong> folder:
</p></li>
</ol>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code6')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code6" class="code-text">
<pre>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">ftp://download.big.ac.cn/gsa/CRA004538/CRR302667/CRR302667.fastq.gz</span> <span class="bash-operator">></span> <span class="bash-string">CRR302667.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span>
</pre>
</div>
</div>
</p>
</div>
<div id="chromosome-subsetting" class="section level3">
<h3>[2] Chromosome subsetting</h3>
<span style="color:black">
<p class="text-justify">
Download the <strong>reference</strong> genome:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code7')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code7" class="code-text">
<pre>
<span class="bash-keyword">nohup</span> <span class="bash-keyword">wget</span> <span class="bash-string">https://download.cncb.ac.cn/gwh/Plants/Arabidopsis_thaliana_AT_GWHBDNP00000000/GWHBDNP00000000.genome.fasta.gz</span> <span class="bash-operator">></span> <span class="bash-string">Arabidopsis_genome.out</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span>
</pre>
</div>
</div>
</p>
<p class="text-justify">
Unzip the compressed file:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code8')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code8" class="code-text">
<pre>
<span class="bash-keyword">unpigz</span> <span class="bash-option">-k</span> <span class="bash-option">-p</span> <span class="bash-value">4</span> <span class="bash-string">GWHBDNP00000000.genome.fasta.gz</span>
</pre>
</div>
</div>
</p>
<p class="text-justify">
Check the headers:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code9')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code9" class="code-text">
<pre>
<span class="bash-keyword">grep</span> <span class="bash-string">">"</span> <span class="bash-string">GWHBDNP00000000.genome.fasta</span> <span class="bash-operator">></span> <span class="bash-string">GWHBDNP00000000.genome_Chr_list.txt</span> <span class="bash-operator">&&</span> <span class="bash-keyword">cat</span> <span class="bash-string">GWHBDNP00000000.genome_Chr_list.txt</span>
</pre>
</div>
</div>
<p><span style="color:black"></p>
</p>
<p class="text-justify">
It should look like this:
</p>
<div class="alert alert-info"
style="display: flex; align-items: center; min-height: 100px; border-radius: 10px; font-family: monospace;">
<table style="color: black; margin: auto; border-collapse: collapse;">
<tr>
<td style="padding-right: 20px;">
GWHBDNP00000001
</td>
<td style="padding-right: 20px;">
Chromosome 1
</td>
<td style="padding-right: 20px;">
Complete=F
</td>
<td style="padding-right: 20px;">
Circular=F
</td>
<td style="padding-right: 20px;">
OriSeqID=chr1
</td>
<td>
Len=32659241
</td>
</tr>
<tr>
<td style="padding-right: 20px;">
GWHBDNP00000002
</td>
<td style="padding-right: 20px;">
Chromosome 2
</td>
<td style="padding-right: 20px;">
Complete=F
</td>
<td style="padding-right: 20px;">
Circular=F
</td>
<td style="padding-right: 20px;">
OriSeqID=chr2
</td>
<td>
Len=22712559
</td>
</tr>
<tr>
<td style="padding-right: 20px;">
GWHBDNP00000003
</td>
<td style="padding-right: 20px;">
Chromosome 3
</td>
<td style="padding-right: 20px;">
Complete=F
</td>
<td style="padding-right: 20px;">
Circular=F
</td>
<td style="padding-right: 20px;">
OriSeqID=chr3
</td>
<td>
Len=26161332
</td>
</tr>
<tr>
<td style="padding-right: 20px;">
GWHBDNP00000004
</td>
<td style="padding-right: 20px;">
Chromosome 4
</td>
<td style="padding-right: 20px;">
Complete=F
</td>
<td style="padding-right: 20px;">
Circular=F
</td>
<td style="padding-right: 20px;">
OriSeqID=chr4
</td>
<td>
Len=22250686
</td>
</tr>
<tr>
<td style="padding-right: 20px;">
GWHBDNP00000005
</td>
<td style="padding-right: 20px;">
Chromosome 5
</td>
<td style="padding-right: 20px;">
Complete=F
</td>
<td style="padding-right: 20px;">
Circular=F
</td>
<td style="padding-right: 20px;">
OriSeqID=chr5
</td>
<td>
Len=30093473
</td>
</tr>
</table>
</div>
</p>
<p class="text-justify">
Next, we will retain only the shortest chromosome:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code10')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code10" class="code-text">
<pre>
<span class="bash-keyword">awk</span> <span class="bash-option">-v</span> <span class="bash-variable">chr=4</span> <span class="bash-string">'
BEGIN {FS="\t"} 
$1 ~ />GWHBDNP/ &amp;&amp; $2 == "Chromosome " chr {print; flag=1; next} 
$1 ~ />GWHBDNP/ &amp;&amp; $2 != "Chromosome " chr {flag=0} 
flag
'</span> <span class="bash-string">GWHBDNP00000000.genome.fasta</span> <span class="bash-operator">></span> <span class="bash-string">Arabidopsis_GWHBDNP00000000_chr4.fasta</span>
</pre>
</div>
</div>
</p>
<p class="text-justify">
Additionally, let’s <strong><a
href="https://pmbio.org/module-02-inputs/0002/04/01/Indexing/">index</a></strong>
the reference genome:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code11')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code11" class="code-text">
<pre>
<span class="bash-keyword">minimap2</span> <span class="bash-option">-d</span> <span class="bash-string">Arabidopsis_GWHBDNP00000000_index.mmi</span> <span class="bash-string">GWHBDNP00000000.genome.fasta</span>
</pre>
</div>
</div>
</p>
<p class="text-justify">
And Chromsome 4 to speed up subsequent alignments:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code12')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code12" class="code-text">
<pre>
<span class="bash-keyword">hisat2-build</span> <span class="bash-string">Arabidopsis_GWHBDNP00000000_chr4.fasta</span> <span class="bash-string">hisat2_Arabidopsis_GWHBDNP00000000_chr4</span>
</pre>
</div>
</div>
</div>
<div id="trimming-and-alignment" class="section level3">
<h3>[3] Trimming and alignment</h3>
<span style="color:black">
<p class="text-justify">
Next, we will remove adapter sequences and retain only high-quality
reads.
</p>
<div id="illumina-dna-data" class="section level4">
<h4>Illumina DNA data</h4>
<span style="color:black">
<p class="text-justify">
Trimming:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code13')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code13" class="code-text">
<pre>
<span class="bash-keyword">trim_galore</span> \
<span class="bash-option">--cores</span> <span class="bash-value">8</span> \
<span class="bash-option">--paired</span> \
<span class="bash-option">--quality</span> <span class="bash-value">30</span> \
<span class="bash-option">--length</span> <span class="bash-value">100</span> \
<span class="bash-option">--clip_R1</span> <span class="bash-value">15</span> \
<span class="bash-option">--clip_R2</span> <span class="bash-value">15</span> \
<span class="bash-option">--three_prime_clip_R1</span> <span class="bash-value">10</span> \
<span class="bash-option">--three_prime_clip_R2</span> <span class="bash-value">10</span> \
<span class="bash-option">--dont_gzip</span> \
<span class="bash-string">CRR302670_f1.fastq.gz</span> <span class="bash-string">CRR302670_r2.fastq.gz</span>
</pre>
</div>
</div>
</p>
<p class="text-justify">
Alignment (do not forget to specify the path for the <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">-x</code> </span> parameter and create the <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">Temp_samtools</code> </span> folder):
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code14')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code14" class="code-text">
<pre><span class="bash-keyword">nohup</span> <span class="bash-keyword">sh</span> <span class="bash-value">-c</span> <span class="bash-value">'</span><span class="bash-keyword">hisat2</span> \
<span class="bash-option">-p</span> <span class="bash-value">44</span> \
<span class="bash-option">--reorder</span> \
<span class="bash-option">--no-mixed</span> \
<span class="bash-option">--no-discordant</span> \
<span class="bash-option">--no-unal</span> \
<span class="bash-option">--sam-no-qname-trunc</span> \
<span class="bash-operator">-x</span> <span class="bash-string">hisat2_Arabidopsis_GWHBDNP00000000_chr4</span> \
<span class="bash-operator">-1</span> <span class="bash-string">CRR302670_f1_val_1.fq</span> \
<span class="bash-operator">-2</span> <span class="bash-string">CRR302670_r2_val_2.fq</span> \
<span class="bash-option">-S</span> <span class="bash-operator">-</span> <span class="bash-operator">|</span> \
<span class="bash-keyword">samtools</span> <span class="bash-keyword">view</span> <span class="bash-option">-@</span> <span class="bash-value">44</span> <span class="bash-option">-Sb</span> <span class="bash-option">-F</span> <span class="bash-value">4</span> <span class="bash-operator">-</span> <span class="bash-operator">|</span> \
<span class="bash-keyword">samtools</span> <span class="bash-keyword">sort</span> <span class="bash-option">-@</span> <span class="bash-value">44</span> <span class="bash-option">-m</span> <span class="bash-value">10G</span> <span class="bash-option">-T</span> <span class="bash-string">/Temp_samtools</span> <span class="bash-option">-o</span> <span class="bash-string">DNA_Illumina_sorted.bam</span> <span class="bash-operator">-</span> <span class="bash-operator">&&</span> \
<span class="bash-keyword">samtools</span> <span class="bash-keyword">fastq</span> <span class="bash-option">-@</span> <span class="bash-value">22</span> \
<span class="bash-operator">-1</span> <span class="bash-string">DNA_Illumina_chr4_R1.fastq</span> \
<span class="bash-operator">-2</span> <span class="bash-string">DNA_Illumina_chr4_R2.fastq</span> \
<span class="bash-string">DNA_Illumina_sorted.bam</span><span class="bash-value">'</span> <span class="bash-operator">&</span></pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
Subsampling. We will keep only 75% of the reads:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code15')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code15" class="code-text">
<pre>
<span class="bash-keyword">for</span> <span class="bash-variable">suffix</span> <span class="bash-keyword">in</span> <span class="bash-string">R1</span> <span class="bash-string">R2</span>; <span class="bash-keyword">do</span>
  <span class="bash-keyword">seqtk</span> <span class="bash-keyword">sample</span> <span class="bash-option">-s</span> <span class="bash-value">77</span> <span class="bash-string">"DNA_Illumina_chr4_${suffix}.fastq"</span> <span class="bash-value">0.75</span> <span class="bash-operator">></span> <span class="bash-string">"DNA_Illumina_chr4_subset_${suffix}.fastq"</span>
<span class="bash-keyword">done</span>
</pre>
</div>
</div>
</p>
</div>
<div id="illumina-rna-data" class="section level4">
<h4>Illumina RNA data</h4>
<span style="color:black">
<p class="text-justify">
Convert the SRA files into FASTQ:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code16')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code16" class="code-text">
<pre>
<span class="bash-keyword">for</span> <span class="bash-variable">srr_id</span> <span class="bash-keyword">in</span> <span class="bash-string">SRR3581706</span> <span class="bash-string">SRR3581708</span> <span class="bash-string">SRR3581693</span> <span class="bash-string">SRR3581681</span> <span class="bash-string">SRR3581356</span> <span class="bash-string">SRR3581705</span> <span class="bash-string">SRR3581703</span>; <span class="bash-keyword">do</span>
  <span class="bash-keyword">fasterq-dump</span> <span class="bash-option">--threads</span> <span class="bash-value">44</span> <span class="bash-option">--split-files</span> <span class="bash-string">"$srr_id"</span>
<span class="bash-keyword">done</span>
</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
Trimming:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code17')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code17" class="code-text">
<pre>
<span class="bash-keyword">parallel</span> <span class="bash-option">-j</span> <span class="bash-value">4</span> <span class="bash-keyword">"nohup trim_galore</span> <span class="bash-option">-q 20 --cores 4</span> <span class="bash-string">{}.fastq</span> <span class="bash-keyword">></span> <span class="bash-string">{}_trim.log</span> <span class="bash-keyword">2>&1 &"</span> \
<span class="bash-operator">:::</span> <span class="bash-string">SRR3581706</span> <span class="bash-string">SRR3581708</span> <span class="bash-string">SRR3581693</span> <span class="bash-string">SRR3581681</span> <span class="bash-string">SRR3581356</span> <span class="bash-string">SRR3581705</span> <span class="bash-string">SRR3581703</span>
</pre>
</div>
</div>
</p>
<p class="text-justify">
Alignment (do not forget to specify the path for the <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">-x</code> </span> parameter):
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code18')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code18" class="code-text">
<pre><span class="bash-variable">SAMPLES</span><span class="bash-operator">=(</span><span class="bash-string">SRR3581706</span> <span class="bash-string">SRR3581708</span> <span class="bash-string">SRR3581693</span> <span class="bash-string">SRR3581681</span> <span class="bash-string">SRR3581356</span> <span class="bash-string">SRR3581705</span> <span class="bash-string">SRR3581703</span><span class="bash-operator">)</span>
<span class="bash-keyword">for</span> <span class="bash-variable">SAMPLE</span> <span class="bash-keyword">in</span> <span class="bash-string">"</span><span class="bash-operator">${</span><span class="bash-variable">SAMPLES</span><span class="bash-operator">[@]</span><span class="bash-string">}"</span>; <span class="bash-keyword">do</span>
  <span class="bash-keyword">nohup</span> <span class="bash-keyword">bash</span> <span style="color: white;"><span class="bash-option">-c</span> <span class="bash-option">"</span>
  <span class="bash-keyword">hisat2</span> <span style="color: white;"><span class="bash-option">-p</span> <span class="bash-value">12</span> <span class="bash-option">--no-unal</span> <span class="bash-option">--sam-no-qname-trunc</span> \
  <span class="bash-keyword">-x</span> <span class="bash-string">hisat2_Arabidopsis_GWHBDNP00000000_chr4</span> \
  <span class="bash-option">--rna-strandness</span> <span class="bash-option">F</span> \
  <span class="bash-option">-U</span> '<span class="bash-operator">${</span><span class="bash-variable">SAMPLE</span><span class="bash-operator">}</span><span class="bash-string">_trimmed.fq</span>' \
  <span class="bash-option">-S</span> '<span class="bash-operator">${</span><span class="bash-variable">SAMPLE</span><span class="bash-operator">}</span><span class="bash-string">.sam</span>' <span class="bash-operator">&&</span> \
  <span class="bash-keyword">samtools</span> <span class="bash-keyword">view</span> <span class="bash-option">-@</span> <span class="bash-value">12</span> <span class="bash-option">-Sb</span> <span class="bash-option">-F</span> <span class="bash-value">4</span> <span class="bash-option">-q</span> <span class="bash-value">20</span> '<span class="bash-operator">${</span><span class="bash-variable">SAMPLE</span><span class="bash-operator">}</span><span class="bash-string">.sam</span>' <span class="bash-operator">></span> '<span class="bash-operator">${</span><span class="bash-variable">SAMPLE</span><span class="bash-operator">}</span><span class="bash-string">.bam</span>' <span class="bash-operator">&&</span> \
  <span class="bash-keyword">samtools</span> <span class="bash-keyword">sort</span> <span class="bash-option">-@</span> <span class="bash-value">12</span> <span class="bash-option">-m</span> <span class="bash-value">10G</span> <span class="bash-option">-o</span> '<span class="bash-operator">${</span><span class="bash-variable">SAMPLE</span><span class="bash-operator">}</span><span class="bash-string">_RNA_Illumina_chr4_subset.bam</span>' '<span class="bash-operator">${</span><span class="bash-variable">SAMPLE</span><span class="bash-operator">}</span><span class="bash-string">.bam</span>' <span class="bash-operator">&&</span> \
  <span class="bash-keyword">samtools</span> <span class="bash-keyword">fastq</span> <span class="bash-option">-@</span> <span class="bash-value">12</span> '<span class="bash-operator">${</span><span class="bash-variable">SAMPLE</span><span class="bash-operator">}</span><span class="bash-string">_RNA_Illumina_chr4_subset.bam</span>' <span class="bash-operator">></span> '<span class="bash-operator">${</span><span class="bash-variable">SAMPLE</span><span class="bash-operator">}</span><span class="bash-string">_RNA_Illumina_chr4_subset.fastq</span>' <span class="bash-operator">&&</span> \
  <span class="bash-keyword">rm</span> <span class="bash-option">-f</span> '<span class="bash-operator">${</span><span class="bash-variable">SAMPLE</span><span class="bash-operator">}</span><span class="bash-string">.sam</span>' '<span class="bash-operator">${</span><span class="bash-variable">SAMPLE</span><span class="bash-operator">}</span><span class="bash-string">.bam</span>'
  "</span> <span class="bash-operator">></span> <span class="bash-string">"</span><span class="bash-operator">${</span><span class="bash-variable">SAMPLE</span><span class="bash-operator">}</span><span class="bash-string">.log"</span> <span class="bash-operator">2>&1</span> <span class="bash-operator">&</span>
<span class="bash-keyword">done</span></pre>
</div>
</div>
</p>
</div>
<div id="illumina-hi-c-data" class="section level4">
<h4>Illumina Hi-C data</h4>
<span style="color:black">
<p class="text-justify">
Trimming:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code19')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code19" class="code-text">
<pre>
<span class="bash-keyword">trim_galore</span> \
<span class="bash-option">--cores</span> <span class="bash-value">8</span> \
<span class="bash-option">--paired</span> \
<span class="bash-option">--quality</span> <span class="bash-value">30</span> \
<span class="bash-option">--length</span> <span class="bash-value">100</span> \
<span class="bash-option">--clip_R1</span> <span class="bash-value">15</span> \
<span class="bash-option">--clip_R2</span> <span class="bash-value">15</span> \
<span class="bash-option">--three_prime_clip_R1</span> <span class="bash-value">10</span> \
<span class="bash-option">--three_prime_clip_R2</span> <span class="bash-value">10</span> \
<span class="bash-option">--dont_gzip</span> \
<span class="bash-string">CRR302669_f1.fastq.gz</span> <span class="bash-string">CRR302669_r2.fastq.gz</span>
</pre>
</div>
</div>
</p>
</p>
<p class="text-justify">
Alignment (do not forget to specify the path for the <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">-x</code> </span> parameter and create the <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">Temp_samtools</code> </span> folder):
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code20')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code20" class="code-text">
<pre><span class="bash-keyword">nohup</span> <span class="bash-keyword">sh</span> <span class="bash-operator">-c</span> <span class="bash-option">'<span class="bash-keyword">hisat2</span> <span style="color: white;"><span class="bash-option">-p</span> <span class="bash-value">22</span> <span class="bash-option">--reorder</span> <span class="bash-option">--no-mixed</span> <span class="bash-option">--no-discordant</span> <span class="bash-option">--no-unal</span> <span class="bash-option">--sam-no-qname-trunc</span> \
<span class="bash-option">--no-spliced-alignment</span> \
<span class="bash-keyword">-x</span> <span class="bash-string">hisat2_Arabidopsis_GWHBDNP00000000_chr4</span> \
<span class="bash-keyword">-1</span> <span class="bash-string">CRR302669_f1_val_1.fq</span> \
<span class="bash-keyword">-2</span> <span class="bash-string">CRR302669_r2_val_2.fq</span> \
<span class="bash-option">-S</span> <span class="bash-operator">-</span> <span class="bash-operator">|</span> \
<span class="bash-keyword">samtools</span> <span class="bash-keyword">view</span> <span class="bash-option">-@</span> <span class="bash-value">22</span> <span class="bash-option">-Sb</span> <span class="bash-option">-F</span> <span class="bash-value">4</span> <span class="bash-operator">-</span> <span class="bash-operator">|</span> \
<span class="bash-keyword">samtools</span> <span class="bash-keyword">sort</span> <span class="bash-option">-n</span> <span class="bash-option">-@</span> <span class="bash-value">22</span> <span class="bash-option">-m</span> <span class="bash-value">10G</span> <span class="bash-option">-T</span> <span class="bash-string">/Temp_samtools</span> <span class="bash-option">-o</span> <span class="bash-string">Hi_C_Illumina_chr4.bam</span> <span class="bash-operator">-</span> <span class="bash-operator">&&</span> \
<span class="bash-keyword">samtools</span> <span class="bash-keyword">fastq</span> <span class="bash-option">-@</span> <span class="bash-value">22</span> \
<span class="bash-keyword">-1</span> <span class="bash-string">Hi_C_Illumina_chr4_R1.fastq</span> \
<span class="bash-keyword">-2</span> <span class="bash-string">Hi_C_Illumina_chr4_R2.fastq</span> \
<span class="bash-string">Hi_C_Illumina_chr4.bam</span>'</span> <span class="bash-operator">&</span></pre>
</div>
</div>
</p>
</div>
<div id="pacbio-hifi-data" class="section level4">
<h4>PacBio HiFi data</h4>
<span style="color:black">
<p class="text-justify">
Trimming:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code21')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code21" class="code-text">
<pre>
<span class="bash-keyword">cutadapt</span> \
<span class="bash-option">-j</span> <span class="bash-value">20</span> \
<span class="bash-option">-a</span> <span class="bash-string">"AATGTACTTCGTTCAGTTACGTATTGCT"</span> \
<span class="bash-option">-a</span> <span class="bash-string">"AGAGTACATGGGAGTTGGTTATGGTAAT"</span> \
<span class="bash-option">--quality-cutoff</span> <span class="bash-value">30</span> \
<span class="bash-option">-m</span> <span class="bash-value">5000</span> \
<span class="bash-option">-M</span> <span class="bash-value">30000</span> \
<span class="bash-option">-o</span> <span class="bash-string">HiFi_trimmed.fastq.gz</span> \
<span class="bash-string">CRR302668.fastq.gz</span>
</pre>
</div>
</div>
</p>
<p class="text-justify">
Alignment (do not forget to create the <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">Temp_samtools</code> </span> :
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code22')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code22" class="code-text">
<pre>
<span class="bash-keyword">minimap2</span> <span class="bash-option">-ax</span> <span class="bash-option">map-hifi</span> <span class="bash-option">-t</span> <span class="bash-value">44</span></span> <span class="bash-string">Arabidopsis_GWHBDNP00000000_chr4.fasta</span></span> <span class="bash-string">HiFi_trimmed.fastq.gz</span></span> <span class="bash-operator">|</span> \
<span class="bash-keyword">samtools</span> <span class="bash-keyword">view</span> <span class="bash-option">-@</span> <span class="bash-value">22</span> <span class="bash-option">-Sb</span> <span class="bash-option">-F</span> <span class="bash-value">4</span> <span class="bash-option">-F</span> <span class="bash-value">256</span> <span class="bash-option">-F</span> <span class="bash-value">2048</span> <span class="bash-option">-q</span> <span class="bash-value">50</span></span> <span class="bash-operator">|</span> \
<span class="bash-keyword">samtools</span> <span class="bash-keyword">sort</span> <span class="bash-option">-@</span> <span class="bash-value">22</span> <span class="bash-option">-m</span> <span class="bash-value">10G</span> <span class="bash-option">-T</span> <span class="bash-string">/Temp_samtools</span> <span class="bash-option">-o</span></span> <span class="bash-string">HiFi_chr4.bam</span> <span class="bash-operator">-</span> <span class="bash-operator">&&</span> \
<span class="bash-keyword">samtools</span> <span class="bash-keyword">fastq</span> <span class="bash-option">-@</span> <span class="bash-value">22</span></span> <span class="bash-string">HiFi_chr4.bam</span> <span class="bash-operator">></span> <span class="bash-string">HiFi_chr4.fastq</span>
</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
Subsampling. We will keep only 75% of the reads:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code23')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code23" class="code-text">
<pre>
<span class="bash-keyword">seqtk</span> <span class="bash-keyword">sample</span> <span class="bash-option">-s</span> <span class="bash-value">77</span> <span class="bash-string">HiFi_chr4.fastq</span> <span class="bash-value">0.75</span> <span class="bash-operator">></span> <span class="bash-string">HiFi_chr4_subset.fastq</span>
</pre>
</div>
</div>
</p>
</div>
<div id="ont-data" class="section level4">
<h4>ONT data</h4>
<span style="color:black">
<p class="text-justify">
Trimming:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code24')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code24" class="code-text">
<pre>
<span class="bash-keyword">porechop</span> <span class="bash-value">--threads 44</span> <span class="bash-value">-i</span> <span class="bash-string">CRR302667.fastq.gz</span> <span class="bash-value">-o</span> <span class="bash-string">ONT_trimmed.fastq.gz</span>
</pre>
</div>
</div>
</p>
<p class="text-justify">
Correction. Since aligning with uncorrected ONT reads might not be the
best approach, we first correct them using <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">NECAT</code> </span> by creating an <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">arabidopsis_config.txt</code> </span> file, where <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">read_list.txt</code> </span> specifies the path to <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">ONT_trimmed.fastq.gz</code> </span>:
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><font size="2"> <span style="color:black"> PROJECT=Arabidopsis<br/>
ONT_READ_LIST=read_list.txt<br/> GENOME_SIZE=135000000<br/>
THREADS=44<br/> MIN_READ_LENGTH=10000<br/> PREP_OUTPUT_COVERAGE=40<br/>
OVLP_FAST_OPTIONS=-n 500 -z 20 -b 2000 -e 0.5 -j 0 -u 1 -a 1000<br/>
OVLP_SENSITIVE_OPTIONS=-n 500 -z 10 -e 0.5 -j 0 -u 1 -a 1000<br/>
CNS_FAST_OPTIONS=-a 2000 -x 4 -y 12 -l 1000 -e 0.5 -p 0.8 -u 0<br/>
CNS_SENSITIVE_OPTIONS=-a 2000 -x 4 -y 12 -l 1000 -e 0.5 -p 0.8 -u 0<br/>
TRIM_OVLP_OPTIONS=-n 100 -z 10 -b 2000 -e 0.5 -j 1 -u 1 -a 400<br/>
ASM_OVLP_OPTIONS=-n 100 -z 10 -b 2000 -e 0.5 -j 1 -u 0 -a 400<br/>
NUM_ITER=2<br/> CNS_OUTPUT_COVERAGE=40<br/> CLEANUP=1<br/>
USE_GRID=false<br/> GRID_NODE=0<br/> GRID_OPTIONS=<br/>
SMALL_MEMORY=0<br/> FSA_OL_FILTER_OPTIONS=<br/>
FSA_ASSEMBLE_OPTIONS=<br/> FSA_CTG_BRIDGE_OPTIONS=<br/>
POLISH_CONTIGS=true<br/> </span> </font></p>
</div>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code25')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code25" class="code-text">
<pre>
<span class="bash-keyword">necat</span> <span class="bash-option">correct</span> <span class="bash-string">arabidopsis_config.txt</span>
</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
Alignment with corrected reads to the reference genome:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code26')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code26" class="code-text">
<pre>
<span class="bash-keyword">minimap2</span> <span class="bash-option">-ax</span> <span class="bash-option">map-ont</span> <span class="bash-option">-t</span> <span class="bash-value">44</span> <span class="bash-string">GWHBDNP00000000.genome.fasta</span> <span class="bash-string">cns_final.fasta.gz</span> <span class="bash-operator">|</span> \
<span class="bash-keyword">samtools</span> <span class="bash-keyword">sort</span> <span class="bash-option">-@</span> <span class="bash-value">44</span> <span class="bash-option">-o</span> <span class="bash-string">full_align.bam</span>
</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
Index the bam file:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code27')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code27" class="code-text">
<pre>
<span class="bash-keyword">samtools</span> <span class="bash-keyword">index</span> <span class="bash-string">full_align.bam</span>
</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
Extract reads mapping uniquely to Chromosome 4:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code28')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code28" class="code-text">
<pre>
<span class="bash-keyword">samtools</span> <span class="bash-keyword">view</span> <span class="bash-option">-@</span> <span class="bash-value">22</span></span> <span class="bash-option">-b</span></span> <span class="bash-option">-q</span> <span class="bash-value">20</span></span> <span class="bash-option">-F</span> <span class="bash-value">256</span></span> <span class="bash-option">-F</span> <span class="bash-value">2048</span></span> <span class="bash-string">full_align.bam</span> <span class="bash-string">"GWHBDNP00000004"</span></span> <span class="bash-option">-o</span> <span class="bash-string">ONT_chr4.bam</span>
</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
And convert BAM to FASTQ:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code29')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code29" class="code-text">
<pre>
<span class="bash-keyword">samtools</span> <span class="bash-keyword">fastq</span> <span class="bash-option">-@</span> <span class="bash-value">22</span></span> <span class="bash-string">ONT_chr4.bam</span></span> <span class="bash-operator">></span> <span class="bash-string">ONT_chr4.fastq</span>
</pre>
</div>
</div>
</p>
</div>
</div>
<div id="sabsampling-for-the-qc-chapter" class="section level3">
<h3>[4] Sabsampling for the QC chapter</h3>
<div id="illumina-dna-data-1" class="section level4">
<h4>Illumina DNA data</h4>
<span style="color:black">
<p class="text-justify">
Let’s keep only 5% of the reads for downstream quality checks:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code30')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code30" class="code-text">
<pre>
<span class="bash-keyword">seqtk</span> <span class="bash-keyword">sample</span> <span class="bash-option">-s</span> <span class="bash-value">11</span></span> <span class="bash-string">CRR302670_f1.fastq.gz</span></span> <span class="bash-value">0.05</span></span> <span class="bash-operator">|</span> <span class="bash-keyword">gzip</span> <span class="bash-operator">></span> <span class="bash-string">DNA_Illumina_QC.fastq.gz</span>
</pre>
</div>
</div>
</div>
<div id="pacbio-hifi-data-1" class="section level4">
<h4>PacBio HiFi data</h4>
<span style="color:black">
<p class="text-justify">
We retain only 1% of the reads:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code31')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code31" class="code-text">
<pre>
<span class="bash-keyword">seqtk</span> <span class="bash-keyword">sample</span> <span class="bash-option">-s</span> <span class="bash-value">77</span></span> <span class="bash-string">CRR302668.fastq.gz</span></span> <span class="bash-value">0.01</span></span> <span class="bash-operator">|</span> <span class="bash-keyword">gzip</span> <span class="bash-operator">></span> <span class="bash-string">HiFi_QC.fastq.gz</span>
</pre>
</div>
</div>
</div>
<div id="ont-data-1" class="section level4">
<h4>ONT data</h4>
<span style="color:black">
<p class="text-justify">
Here, we also retain only 1% of the reads:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code32')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code32" class="code-text">
<pre>
<span class="bash-keyword">seqtk</span> <span class="bash-keyword">sample</span> <span class="bash-option">-s</span> <span class="bash-value">77</span></span> <span class="bash-string">CRR302667.fastq.gz</span></span> <span class="bash-value">0.01</span></span> <span class="bash-operator">|</span> <span class="bash-keyword">gzip</span> <span class="bash-operator">></span> <span class="bash-string">ONT_QC.fastq.gz</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="iii-genome-assembly" class="section level1">
<h1>[III] Genome assembly</h1>
<div id="recap" class="section level2">
<h2>Recap</h2>
<span style="color:black">
<p class="text-justify">
Genome assembly is like rebuilding the Great Wall. The original wall is
unique, but it has many identical sections (such as watchtowers and
repeating brick patterns) repeated along its length. If you break the
wall into tiny pieces (similar to how DNA is fragmented during
sequencing), rebuilding it perfectly becomes challenging because
repeating structures make it difficult to determine how the pieces fit
together. To solve this, we can use different sequencing technologies:
</p>
<ol style="list-style-type: decimal">
<li>Illumina (short reads): provides highly accurate details of small
fragments (like individual bricks). However, it struggles with long
repetitive sections (e.g., repeated watchtowers), leaving gaps in the
reconstruction.</li>
<li>PacBio HiFi (long reads): captures longer sequences and can bridge
many repetitive regions. However, it may still fail to resolve extremely
long identical sections (e.g., massive fortress-like structures).</li>
<li>ONT PromethION (ultra-long reads): spans entire sections of the
wall, revealing how large repeating structures are connected. Drawback:
these reads have more errors and need fixing.
</p></li>
</ol>
<p><strong>Goal</strong>: Rebuild the Great Wall (genome) exactly as it
was, with no misplaced bricks.</p>
<strong>Solution</strong>: use ultra-long reads (ONT) to map how giant
repeating sections connect; refine the structure with long reads (HiFi)
and short reads (Illumina) to fix errors and ensure every brick is in
the right place (<strong>Figure 1</strong>).
</p>
<img src="Fig_1.svg" style="width: 100%; height: auto; border: 1px solid #ddd; border-radius: 10px;">
<span style="color:black">
<p class="text-center">
<strong>Figure 1</strong>. Overview of the sequencing technologies used
in this tutorial.
</p>
</p>
<span style="color:black">
<p class="text-justify">
Here, we will use a hybrid genome assembly pipeline, as illustrated in
<strong>Figure 2</strong>.
</p>
<img src="Fig_2.svg" style="width: 100%; height: auto; border: 1px solid #ddd; border-radius: 10px;">
<span style="color:black">
<p class="text-center">
<strong>Figure 2</strong>. Key steps in the hybrid genome assembly
pipeline.
</p>
</div>
<div id="quality-check" class="section level2">
<h2>Quality check</h2>
<div id="short-read-sequencing" class="section level3">
<h3>Short-Read Sequencing</h3>
<span style="color:black">
<p class="text-justify">
Let’s perform a quick quality check using Illumina DNA reads:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code33')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code33" class="code-text">
<pre>fastqc DNA_Illumina_QC.fastq.gz</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
And check the resulted file <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">DNA_Illumina_QC_fastqc.html</code> </span> (<strong>Figure
3</strong>):
</p>
<div style="width: 100%; overflow: hidden; margin: 0; padding: 0;">
<div style="&#10;      transform: scale(0.85);&#10;      transform-origin: 0 0;&#10;      width: 977px;&#10;      height: 800px;&#10;      /* Remove or reduce negative margin */&#10;      margin-bottom: -100px;&#10;    ">
<iframe title="DNA_Illumina_QC_fastqc.html" src="E:/Work_place_XTBG_China/Tutorial_XTBG_2025/Tutorial/Genome_Assembly_XTBG_2025/Fig_3_DNA_Illumina_QC_fastqc.html" style="&#10;        border: none;&#10;        outline: none;&#10;        border-radius: 10px;&#10;        width: 100%;&#10;        height: 100%;&#10;      "></iframe>
</div>
</div>
<span style="color:black">
<p class="text-center">
<strong>Figure 3</strong>. The FastQC output report.
</p>
</p>
<span style="color:black">
<p class="text-justify">
Now, we will remove adapters (if present), set a quality threshold of
35, retain only sequences longer than 100 bases, and trim from both the
5’ and 3’ ends:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code34')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code34" class="code-text">
<pre>trim_galore \
--cores 8 \
--quality 35 \
--length 100 \
--clip_R1 15 \
--three_prime_clip_R1 10 \
DNA_Illumina_QC.fastq.gz</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>trim_galore</code></span> Invokes the Trim
Galore! tool (a wrapper for Cutadapt and FastQC)<br/> <span
style="color: blue;"><code>--cores 8</code></span> Uses
<strong>8</strong> CPU cores for parallel processing, speeding up the
trimming<br/> <span
style="color: blue;"><code>--quality 35</code></span> Trims bases with a
Phred quality score below <strong>35</strong> (typical for high-quality
data like Illumina)<br/> <span
style="color: blue;"><code>--length 100</code></span> Discards reads
shorter than 100 bases after trimming<br/> <span
style="color: blue;"><code>--clip_R1 15</code></span> Removes
<strong>15</strong> bases from the 5’ end (start) of Read 1<br/> <span
style="color: blue;"><code>--three_prime_clip_R1 10</code></span>
Removes <strong>10</strong> bases from the 3’ end (end) of Read 1<br/>
<span style="color: blue;"><code>DNA_Illumina_QC.fastq.gz</code></span>
Processes the input file: a gzipped FASTQ file (single-end Illumina
reads)<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
Check the QC of the trimmed reads:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code35')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code35" class="code-text">
<pre>fastqc DNA_Illumina_QC_trimmed.gz</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
Next, check the resulted file <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">DNA_Illumina_QC_trimmed_fastqc.html</code> </span>(<strong>Figure
4</strong>):
</p>
<div style="width: 100%; overflow: hidden; margin: 0; padding: 0;">
<div style="&#10;      transform: scale(0.85);&#10;      transform-origin: 0 0;&#10;      width: 977px;&#10;      height: 800px;&#10;      /* Remove or reduce negative margin */&#10;      margin-bottom: -100px;&#10;    ">
<iframe title="DNA_Illumina_QC_trimmed_fastqc.html" src="E:/Work_place_XTBG_China/Tutorial_XTBG_2025/Tutorial/Genome_Assembly_XTBG_2025/Fig_4_DNA_Illumina_QC_trimmed_fastqc.html" style="&#10;        border: none;&#10;        outline: none;&#10;        border-radius: 10px;&#10;        width: 100%;&#10;        height: 100%;&#10;      "></iframe>
</div>
</div>
<span style="color:black">
<p class="text-center">
<strong>Figure 4</strong>. The FastQC output report for the trimmed
reads.
</p>
</p>
</div>
<div id="long-read-sequencing" class="section level3">
<h3>Long-Read Sequencing</h3>
<div id="pacbio-hifi-reads" class="section level4">
<h4>[1] PacBio HiFi reads</h4>
<span style="color:black">
<p class="text-justify">
Here, we will check the quality of the HiFi reads:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code36')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code36" class="code-text">
<pre>NanoPlot --fastq HiFi_QC.fastq.gz --outdir NanoPlot_HiFi_Report</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>NanoPlot</code></span> Generates plots and
statistics from ONT and PacBio data (read length, quality score &amp;
more)<br/> <span style="color: blue;"><code>--fastq</code></span>
Specifies that the input file is in FASTQ format<br/> <span
style="color: blue;"><code>HiFi_QC.fastq.gz</code></span> The input
file<br/> <span style="color: blue;"><code>--outdir</code></span>
Specifies the directory where the output files (plots, statistics, and
reports) will be saved<br/> <span
style="color: blue;"><code>NanoPlot_HiFi_Report</code></span> The
directory name<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
The resulting report appears in <strong>Figure 5</strong>:
</p>
<div style="width: 100%; margin: 0; padding: 0;">
<div style="&#10;      transform: scale(0.85);&#10;      transform-origin: 0 0;&#10;      width: 977px;&#10;      height: 800px;&#10;      margin-bottom: -100px;&#10;    ">
<iframe title="NanoPlot-report_HiFi.html" src="E:/Work_place_XTBG_China/Tutorial_XTBG_2025/Tutorial/Genome_Assembly_XTBG_2025/Fig_5_NanoPlot_HiFi.html" style="&#10;        border: none;&#10;        outline: none;&#10;        border-radius: 10px;&#10;        width: 100%;&#10;        height: 100%;&#10;        overflow: hidden; /* Ensure iframe content respects border-radius */&#10;      "></iframe>
</div>
</div>
<span style="color:black">
<p class="text-center">
<strong>Figure 5</strong>. The NanoPlot report output for the HiFi
reads.
</p>
</p>
</div>
<div id="ont-reads" class="section level4">
<h4>[2] ONT reads</h4>
<span style="color:black">
<p class="text-justify">
Next, we will check the quality of the ONT reads:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code37')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code37" class="code-text">
<pre>NanoPlot --fastq ONT_QC.fastq.gz --outdir NanoPlot_ONT_Report</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
The resulting report appears in <strong>Figure 6</strong>:
</p>
<div style="width: 100%; overflow: hidden; margin: 0; padding: 0;">
<div style="&#10;      transform: scale(0.85);&#10;      transform-origin: 0 0;&#10;      width: 977px;        &#10;      height: 800px;       &#10;      margin-bottom: -100px;&#10;    ">
<iframe title="NanoPlot_ONT_Report" src="E:/Work_place_XTBG_China/Tutorial_XTBG_2025/Tutorial/Genome_Assembly_XTBG_2025/Fig_6_NanoPlot_ONT.html" style="&#10;        border: none;&#10;        outline: none;&#10;        border-radius: 10px;&#10;        width: 100%;&#10;        height: 100%;&#10;      "></iframe>
</div>
</div>
<span style="color:black">
<p class="text-center">
<strong>Figure 6</strong>. The NanoPlot report output for the ONT reads.
</p>
</p>
</div>
</div>
</div>
<div id="assembly-with-a-reference-genome" class="section level2">
<h2>Assembly with a reference genome</h2>
<div id="flye" class="section level3">
<h3>[1] Flye</h3>
<span style="color:black">
<p class="text-justify">
We will use the <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">Flye</code> </span>:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code38')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code38" class="code-text">
<pre>flye --nano-corr ONT_chr4.fastq \
--out-dir Flye_assembly_chr4 \
--genome-size 22m \
--min-overlap 5000 \
--iterations 3 \
--threads 88</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>flye</code></span> Invokes the Flye
assembler<br/> <span
style="color: blue;"><code>--nano-corr</code></span> Specifies that the
input is error-corrected Nanopore reads<br/> <span
style="color: blue;"><code>ONT_chr4.fastq</code></span> Input file
containing sequencing reads<br/> <span
style="color: blue;"><code>--out-dir Flye_assembly_chr4</code></span>
Output directory for assembly results (contigs, logs, etc.)<br/> <span
style="color: blue;"><code>--genome-size 22m</code></span> Estimated
genome size is 22 million bases<br/> <span
style="color: blue;"><code>--min-overlap 5000</code></span> Requires a
minimum overlap of 5,000 bases between reads to form contigs<br/> <span
style="color: blue;"><code>--iterations 3</code></span> Runs 3 polishing
iterations to refine the assembly (improves accuracy but increases
runtime)<br/> <span
style="color: blue;"><code>--threads 88</code></span> Uses 88 CPU
threads for parallel processing<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
<p>Next, we will index the output file:</span></p>
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code39')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code39" class="code-text">
<pre>samtools faidx assembly.fasta</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>samtools</code></span> A set of tools for
manipulating next-generation sequencing data<br/> <span
style="color: blue;"><code>faidx</code></span> Subcommand for indexing
FASTA files<br/> <span
style="color: blue;"><code>assembly.fasta</code></span> The input FASTA
file<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
<p>And check the content:</span></p>
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code40')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code40" class="code-text">
<pre>cut -f1,2 assembly.fasta.fai</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>cut</code></span> Unix utility to extract
specific columns from a text file<br/> <span
style="color: blue;"><code>-f1,2</code></span> Specifies that columns 1
and 2 should be extracted<br/> <span
style="color: blue;"><code>assembly.fasta.fai</code></span> The input
file<br/> </span> </font></p>
</div>
<p class="text-justify">
It should look like this:
</p>
<div class="alert alert-info"
style="display: flex; align-items: flex-start; min-height: 100px; padding: 15px; border-radius: 10px; font-family: monospace;">
<table style="color: black; border-collapse: collapse; text-align: left;">
<tr>
<td style="padding-right: 20px;">
contig_10
</td>
<td style="padding-right: 20px;">
7816
</td>
</tr>
<tr>
<td style="padding-right: 20px;">
contig_3
</td>
<td style="padding-right: 20px;">
3244749
</td>
</tr>
<tr>
<td style="padding-right: 20px;">
contig_5
</td>
<td style="padding-right: 20px;">
959609
</td>
</tr>
<tr>
<td style="padding-right: 20px;">
contig_6
</td>
<td style="padding-right: 20px;">
14850431
</td>
</tr>
<tr>
<td style="padding-right: 20px;">
contig_7
</td>
<td style="padding-right: 20px;">
12283
</td>
</tr>
</table>
</div>
</p>
</div>
<div id="d-genies" class="section level3">
<h3>[2] D-Genies</h3>
<span style="color:black">
<p class="text-justify">
When we have a reference genome, we can align these contigs alongside
the reference. Let’s use <strong><a
href="https://dgenies.toulouse.inra.fr/run">D-Genies</a></strong>, which
provides a synthetic similarity overview. This software can be run
either locally or online. All you need to do is provide a reference
genome and your newly assembled genome. Here, we will compare <span
style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">assembly.fasta</code> </span>, which we obtained in the previous
step, with the reference genome <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">GWHBDNP00000000.genome.fasta</code> </span>(<strong>Figure
7</strong>):
</p>
<div style="width: 100%; overflow: hidden; margin: 0; padding: 0;">
<div style="&#10;      transform: scale(0.85);&#10;      transform-origin: 0 0;&#10;      width: 977px;        &#10;      height: 800px;       &#10;      margin-bottom: -100px;&#10;    ">
<iframe title="Dgenies_Chr4_vs_GWHBDNP00000000.html" src="E:/Work_place_XTBG_China/Tutorial_XTBG_2025/Tutorial/Genome_Assembly_XTBG_2025/Fig_7_Dgenies_Chr4_vs_GWHBDNP00000000.html" style="&#10;        border: none;&#10;        outline: none;&#10;        border-radius: 10px;&#10;        width: 100%;&#10;        height: 100%;&#10;      "></iframe>
</div>
</div>
<span style="color:black">
<p class="text-center">
<strong>Figure 7</strong>. Synthetic similarities produced by D-Genies:
Reference vs Flye genome.
</p>
</p>
<span style="color:black">
<p class="text-justify">
<p>How do we interpret these dot plots or synthetic similarities?
<strong>Figure 8</strong> summarises the main scenarios using an analogy
with the English alphabet.</p>
<img src="Fig_8_Dot_plots.svg" style="width: 100%; height: auto; border: 1px solid #ddd; border-radius: 10px;">
<span style="color:black">
<p class="text-center">
<strong>Figure 8</strong>. Dot plot interpretation.
</p>
<span style="color:black">
<p class="text-justify">
Let’s remove the two shortest contigs (7 and 10) by editing <span
style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">contigs_to_keep.txt</code> </span> using <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">nano</code> </span>:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code41')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code41" class="code-text">
<pre>cut -f1 assembly.fasta.fai > contigs_to_keep.txt</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
And running <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">seqtk</code> </span>:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code42')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code42" class="code-text">
<pre>seqtk subseq assembly.fasta contigs_to_keep.txt > assembly_3_contigs.fasta</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>seqtk</code></span> Toolkit for working with
sequencing data<br/> <span
style="color: blue;"><code>subseq</code></span> Subcommand to extract
sequences based on a list of identifiers<br/> <span
style="color: blue;"><code>assembly.fasta</code></span> The input FASTA
file<br/> <span
style="color: blue;"><code>contigs_to_keep.txt</code></span> The text
file containing a list of sequence IDs that we want to extract from the
FASTA file<br/> <span style="color: blue;"><code>&gt;</code></span>
Redirects the output of the command to a new file<br/> <span
style="color: blue;"><code>assembly_3_contigs.fasta</code></span> The
output FASTA file containing only the specified sequences<br/> </span>
</font></p>
</div>
</div>
<div id="nextpolish" class="section level3">
<h3>[3] NextPolish</h3>
<span style="color:black">
<p class="text-justify">
In order to improve the draft genome by identifying and correcting
misassemblies and other inconsistencies, we will polish the assembly
using highly accurate short and long (Illumina and HiFi) reads.</span>
</p>
<div id="a-alignment" class="section level4">
<h4>[A] Alignment</h4>
<span style="color:black">
<p class="text-justify">
Here, we will align the HiFi reads on the draft assembly:</span>
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code43')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code43" class="code-text">
<pre>minimap2 -ax map-hifi -t 10 assembly_3_contigs.fasta HiFi_chr4_subset.fastq.gz | \
samtools sort -o hifi.map.sort.bam - && \
samtools index hifi.map.sort.bam</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>minimap2</code></span> Ultrafast sequence
aligner for long reads<br/> <span
style="color: blue;"><code>-ax</code></span> Forces minimap2 to output
in SAM format and defines parameters optimised for specific data
types<br/> <span style="color: blue;"><code>map-hifi</code></span>
Preset optimized for PacBio HiFi reads<br/> <span
style="color: blue;"><code>-t 10</code></span> Specifies 10 CPU threads
for parallel alignment<br/> <span
style="color: blue;"><code>assembly_3_contigs.fasta</code></span>
Reference genome<br/> <span
style="color: blue;"><code>HiFi_chr4_subset.fastq.gz</code></span> HiFi
reads<br/> <span style="color: blue;"><code>|</code></span> Indicates
that output SAM-formatted alignments are streamed to the next
command<br/> <span style="color: blue;"><code>samtools</code></span> A
set of tools for manipulating next-generation sequencing data<br/> <span
style="color: blue;"><code>sort</code></span> Sorts alignments by
genomic coordinates<br/> <span
style="color: blue;"><code>-o</code></span> Indicates the output
file<br/> <span
style="color: blue;"><code>hifi.map.sort.bam</code></span> The output
file<br/> <span style="color: blue;"><code>-</code></span> Takes input
from stdin (the SAM data piped from minimap2)<br/> <span
style="color: blue;"><code>&amp;&amp;</code></span> Ensures that the
next command (samtools index) is executed only if the previous command
(samtools sort) succeeds<br/> <span
style="color: blue;"><code>index</code></span> Creates an index file for
the sorted BAM file<br/> <span
style="color: blue;"><code>hifi.map.sort.bam</code></span> The output
file (from the previous steps) and the input file for indexing<br/>
</span> </font></p>
</div>
</p>
</div>
<div id="b-k-mer-dataset" class="section level4">
<h4>[B] K-mer dataset</h4>
<span style="color:black">
<p class="text-justify">
Next, we will prepare two k-mer datasets by breaking Illumina reads into
smaller pieces (k-mers). These k-mers can further improve the quality of
our genome assembly by identifying and correcting errors such as
sequencing mistakes or misassemblies:</span>
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code44')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code44" class="code-text">
<pre>yak count -o k21.yak -k 21 -b 37 <(zcat DNA_Illumina_chr4_subset_R*.fastq.gz) <(zcat DNA_Illumina_chr4_subset_R*.fastq.gz) &
yak count -o k31.yak -k 31 -b 37 <(zcat DNA_Illumina_chr4_subset_R*.fastq.gz) <(zcat DNA_Illumina_chr4_subset_R*.fastq.gz)</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>yak</code></span> k-mer counting tool<br/>
<span style="color: blue;"><code>count</code></span> Subcommand performs
k-mer counting on the input reads<br/> <span
style="color: blue;"><code>-o</code></span> Specifies the output
file<br/> <span style="color: blue;"><code>k21.yak</code></span> The
output name<br/> <span style="color: blue;"><code>-k 21</code></span>
Specifies the k-mer size<br/> <span
style="color: blue;"><code>-b 37</code></span> Sets the number of bits
used for hashing<br/> <span
style="color: blue;"><code>&lt;(zcat DNA_Illumina_chr4_subset_R*.fastq.gz)</code></span>
Decompresses and streams the contents of compressed FASTQ files directly
into yak<br/> </span> </font></p>
</div>
</div>
<div id="c-polishing" class="section level4">
<h4>[C] Polishing</h4>
<span style="color:black">
<p class="text-justify">
Let’s then use both types of reads to polish the assembly:</span>
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code45')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code45" class="code-text">
<pre>nextPolish2 -r -t 10 hifi.map.sort.bam assembly_3_contigs.fasta k21.yak k31.yak > NP_genome.fa</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>nextPolish2</code></span> Corrects errors in
the assembly<br/> <span style="color: blue;"><code>-r</code></span>
Specifies that the input alignment file<br/> <span
style="color: blue;"><code>-t 10</code></span> Specifies the number of
threads to use for parallel processing<br/> <span
style="color: blue;"><code>hifi.map.sort.bam</code></span> The input BAM
file<br/> <span
style="color: blue;"><code>assembly_3_contigs.fasta</code></span> The
reference sequence<br/> <span
style="color: blue;"><code>k21.yak k31.yak</code></span> k-mer count
files<br/> <span style="color: blue;"><code>NP_genome.fa</code></span>
The final polished sequence<br/> </span> </font></p>
</div>
</div>
<div id="d-final-notes" class="section level4">
<h4>[D] Final notes</h4>
<span style="color:black">
<p class="text-justify">
Additionally, we may want to reverse contig 6:</span>
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code46')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code46" class="code-text">
<pre>samtools faidx NP_genome.fa && \
cut -f1,2 NP_genome.fa.fai && \
(echo "contig_6" > contig_6.txt && \
seqtk subseq NP_genome.fa contig_6.txt | seqtk seq -r > reversed_contig_6.fa && \
grep '^>' NP_genome.fa | cut -d' ' -f1 | tr -d '>' | grep -v "contig_6" | \
seqtk subseq NP_genome.fa /dev/stdin > other_contigs.fa && \
cat other_contigs.fa reversed_contig_6.fa > Final_genome_with_Reference.fa)
</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>echo "contig_6" &gt; contig_6.txt</code></span>
Creates a text file containing only Contig 6<br/> <span
style="color: blue;"><code>seqtk subseq NP_genome.fa contig_6.txt</code></span>
Extracts Contig 6 from the genome assembly<br/> <span
style="color: blue;"><code>seqtk seq -r</code></span> Reverses and
complements the sequence (e.g., converting ACTG to CAGT)<br/> <span
style="color: blue;"><code>grep '^&gt;' NP_genome.fa</code></span>
Extracts all header lines starting with <span
style="color: blue;"><code>&gt;</code></span> from the FASTA file<br/>
<span style="color: blue;"><code>cut -d' ' -f1</code></span> Removes any
additional information after the header (e.g., <strong>&gt;contig_1
info</strong> becomes <strong>&gt;contig_1</strong>)<br/> <span
style="color: blue;"><code>tr -d '&gt;'</code></span> Removes the
<strong>&gt;</strong> symbol from the headers, leaving only the sequence
names<br/> <span
style="color: blue;"><code>grep -v "contig_6"</code></span> Excludes
Contig 6 from the list of sequence names<br/> <span
style="color: blue;"><code>seqtk subseq NP_genome.fa /dev/stdin</code></span>
Extracts sequences directly from the previous command<br/> <span
style="color: blue;"><code>&gt; other_contigs.fa</code></span> Saves the
extracted sequences to a new file<br/> <span
style="color: blue;"><code>cat other_contigs.fa reversed_contig_6.fa</code></span>
Merges the reverse-complemented Contig 6 with the remaining contigs<br/>
<span
style="color: blue;"><code>Final_genome_with_Reference.fa</code></span>
The final combined concatenated FASTA file<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
And check the final assembly with <strong>D-Genies</strong>
(<strong>Figure 9</strong>):</span>
</p>
<div style="width: 100%; overflow: hidden; margin: 0; padding: 0;">
<div style="&#10;      transform: scale(0.85);&#10;      transform-origin: 0 0;&#10;      width: 977px;        &#10;      height: 800px;       &#10;      margin-bottom: -100px;&#10;    ">
<iframe title="Interactive Figure 6" src="E:/Work_place_XTBG_China/Tutorial_XTBG_2025/Tutorial/Genome_Assembly_XTBG_2025/Fig_9_NP_Dgenies_Chr4_vs_GWHBDNP00000000.html" style="&#10;        border: none;&#10;        outline: none;&#10;        border-radius: 10px;&#10;        width: 100%;&#10;        height: 100%;&#10;      "></iframe>
</div>
</div>
<span style="color:black">
<p class="text-center">
<strong>Figure 9</strong>. D-Genies: Reference vs the polished genome.
</p>
</p>
</div>
</div>
</div>
<div id="assembly-without-a-reference-genome" class="section level2">
<h2>Assembly without a reference genome</h2>
<span style="color:black">
<p class="text-justify">
If you have genome-wide chromatin interaction data (<strong><a
href="https://en.wikipedia.org/wiki/Hi-C_(genomic_analysis_technique)">Hi-C</a></strong>),
you can use it to scaffold contigs into chromosome-scale assemblies
without requiring a reference genome.
</p>
<div class="alert alert-info"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> To further explore this workflow, the
following resources are recommended:<br/> (1) <a
href="https://wixlabs-pdf-dev.appspot.com/assets/pdfjs/web/viewer.html?file=%2Fpdfproxy%3Finstance%3DMRuHq7Rbtm_dH7B5Kxt0ktj_93fQjU8G1JqRvjmpDYo.eyJpbnN0YW5jZUlkIjoiOTQwZTczNzYtYTY2My00YzA0LTlkMjctOGVlNDE4YTY5ODc3IiwiYXBwRGVmSWQiOiIxM2VlMTBhMy1lY2I5LTdlZmYtNDI5OC1kMmY5ZjM0YWNmMGQiLCJtZXRhU2l0ZUlkIjoiZjJlY2EyODAtMTQwOC00NjY5LWI5MzctYzc4ZjY4YTJiMDQ1Iiwic2lnbkRhdGUiOiIyMDIyLTA3LTE1VDE0OjM4OjQ5LjY5OVoiLCJkZW1vTW9kZSI6ZmFsc2UsImFpZCI6ImE1NGM1MmE5LTA1NDUtNDFlMi1iOGEzLTllNjgxNWEzMzQ0MSIsImJpVG9rZW4iOiI2NmUyZDFmNi1iMjZiLTBhNmQtMjQxMC00OTZiNzAwNDI4MzIiLCJzaXRlT3duZXJJZCI6IjJiOTMzMGNiLWFhMWUtNGYyOC04NjhkLWNlNGEzMDM4ZTViMCJ9%26compId%3Dcomp-jln9hwb1%26url%3Dhttps%3A%2F%2Fdocs.wixstatic.com%2Fugd%2F2b9330_fd2c3fb050d04c989fe2bb9a762c94f7.pdf&amp;rng=1657895941130#page=1&amp;zoom=auto,-15,800&amp;links=true&amp;allowPrinting=true&amp;allowDownload=true&amp;originalFileName=manual_180322">The
Genome Assembly Cookbook</a> provides a detailed strategy for assembling
chromosome-length genomes using Hi-C data.<br/> (2) <a
href="https://www.youtube.com/c/AidenLab/videos">The Aiden Lab YouTube
channel</a> features instructional content on utilising <a
href="https://github.com/aidenlab/Juicebox">Juicebox Assembly Tools</a>
for genome assembly visualisation and refinement.<br/> </span></p>
</div>
</p>
<div class="alert alert-danger"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <strong>IMPORTANT!</strong> Your directory
structure must be correctly organised for Juicer to function. Follow <a
href="https://github.com/aidenlab/juicer/wiki/Installation#directory-structure">the
instructions</a> closely.</p>
</div>
<p></span></p>
<span style="color:black">
<p class="text-justify">
Further to complete the assembly please follow the steps in this
<strong><a
href="https://niwdoog.github.io/Genome_Assembly_Long_Reads_Hi-C/#Without_a_reference">tutorial</a></strong>.
</p>
</div>
</div>
<div id="iv-genome-annotation" class="section level1">
<h1>[IV] Genome annotation</h1>
<div id="repeat-identification-and-masking" class="section level2">
<h2>Repeat identification and masking</h2>
<span style="color:black">
<p class="text-justify">
<p>Now, we need to identify and mask transposable elements prior to
structural genome annotation.</span></p>
<div id="repeatmodeler" class="section level3">
<h3>[1] RepeatModeler</h3>
<span style="color:black">
<p class="text-justify">
We will use <strong><a
href="https://github.com/Dfam-consortium/RepeatModeler">RepeatModeler</a></strong>,
a <em>de novo</em> Transposable Element family identification and
modeling package.
</p>
<p>First, we will create a formatted BLAST-compatible database from our
genome sequence to facilitate repeat identification:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code47')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code47" class="code-text">
<pre>BuildDatabase -name A.thaliana.DB -engine rmblast Final_genome_with_Reference.fa</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>BuildDatabase</code></span> Prepares a genome
sequence into a database that can be used by RepeatMasker for repeat
annotation<br/> <span
style="color: blue;"><code>-name A.thaliana.DB</code></span> Specifies
the name of the database being created<br/> <span
style="color: blue;"><code>-engine rmblast</code></span> Specifies the
search engine to use for building the database<br/> <span
style="color: blue;"><code>Final_genome_with_Reference.fa</code></span>
The input FASTA file<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
<p>And identify repetitive elements in the genome without relying on
existing repeat libraries:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code48')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code48" class="code-text">
<pre>RepeatModeler -database A.thaliana.DB -engine rmblast -threads 10</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>RepeatModeler</code></span> Identifies and
classifies repetitive elements in genomic sequences<br/> <span
style="color: blue;"><code>-database A.thaliana.DB</code></span>
Specifies the name of the database to analyse<br/> <span
style="color: blue;"><code>-engine rmblast</code></span> Specifies the
search engine to use for building the database<br/> <span
style="color: blue;"><code>-threads 10</code></span> Specifies the
number of threads (CPU cores) to use for parallel processing<br/>
</span> </font></p>
</div>
</div>
<div id="repeatmasker" class="section level3">
<h3>[2] RepeatMasker</h3>
<span style="color:black">
<p class="text-justify">
<p>Secondly, we will use <strong><a
href="https://github.com/rmhubley/RepeatMasker">RepeatMasker</a></strong>
to mask the TEs identified by RepeatModeler:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code49')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code49" class="code-text">
<pre>RepeatMasker -pa 16 -xsmall -gff -lib consensi.fa.classified Final_genome_with_Reference.fa</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>RepeatMasker</code></span> Identifies and
masks repetitive elements<br/> <span
style="color: blue;"><code>-pa 16</code></span> Specifies the number of
parallel processes <br/> <span
style="color: blue;"><code>-xsmall</code></span> Softmasking (specifies
that masked bases should be represented in lowercase instead of being
replaced with N)<br/> <span
style="color: blue;"><code>-gff</code></span> Specifies output format
(General Feature Format, GFF)<br/> <span
style="color: blue;"><code>-lib consensi.fa.classified</code></span>
Specifies the custom repeat library to use for the analysis<br/> <span
style="color: blue;"><code>Final_genome_with_Reference.fa</code></span>
The input FASTA file<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
Your results will be stored in a tabular file (see <span style="
  background-color: #D9EDF7;
  display: inline-block;
  vertical-align: text-bottom;
  line-height: 1.2;
  padding: 0 5px;
  font-size: 1em;
"> <code style="
    background-color: inherit;
    font-family: inherit;
    margin: 0;
    padding: 0;
    font-weight: bold; <!-- Added CSS bold -->
  ">Final_genome_with_Reference.fa.tbl</code> </span>):
</p>
<div class="alert alert-success" style="border-radius: 10px; padding: 10px; overflow-x: auto;"">
  <pre style="color: black; background: transparent; border: none; margin: 0px 10px; padding: 0;">
==================================================
file name: Final_genome_with_Reference.fa
sequences:             3
total length:   19099067 bp  (19099067 bp excl N/X-runs)
GC level:         36.27 %
bases masked:    2565276 bp ( 13.43 %)
==================================================
               number of      length   percentage
               elements*    occupied  of sequence
--------------------------------------------------
Retroelements          950       908681 bp    4.76 %
   SINEs:                0            0 bp    0.00 %
   Penelope:             0            0 bp    0.00 %
   LINEs:              139        70941 bp    0.37 %
    CRE/SLACS            0            0 bp    0.00 %
     L2/CR1/Rex          0            0 bp    0.00 %
     R1/LOA/Jockey       0            0 bp    0.00 %
     R2/R4/NeSL          0            0 bp    0.00 %
     RTE/Bov-B           0            0 bp    0.00 %
     L1/CIN4           139        70941 bp    0.37 %
   LTR elements:       811       837740 bp    4.39 %
     BEL/Pao             0            0 bp    0.00 %
     Ty1/Copia          86        53177 bp    0.28 %
     Gypsy/DIRS1       725       784563 bp    4.11 %
       Retroviral        0            0 bp    0.00 %

DNA transposons        120        65243 bp    0.34 %
   hobo-Activator        0            0 bp    0.00 %
   Tc1-IS630-Pogo        0            0 bp    0.00 %
   En-Spm                0            0 bp    0.00 %
   MULE-MuDR            83        29184 bp    0.15 %
   PiggyBac              0            0 bp    0.00 %
   Tourist/Harbinger     0            0 bp    0.00 %
   Other (Mirage,        0            0 bp    0.00 %
    P-element, Transib)

Rolling-circles         26         5940 bp    0.03 %

Unclassified:         5043      1258310 bp    6.59 %

Total interspersed repeats:     2232234 bp   11.69 %


Small RNA:               0            0 bp    0.00 %

Satellites:              0            0 bp    0.00 %
Simple repeats:       5922       239827 bp    1.26 %
Low complexity:       1499        87275 bp    0.46 %
==================================================

* most repeats fragmented by insertions or deletions
  have been counted as one element</pre></div>
<div class="alert alert-info"
style="display: flex; border-radius: 10px;">
<p><span style="color:black">Please note that the current steps of
repeat identification and masking are rather simplistic, and you may
want to take a closer look at a more sophisticated approach, such as the
one provided by <strong><a
href="https://darencard.net/blog/2022-07-09-genome-repeat-annotation/">Dr. Daren
Card</a></strong>.<br/> </span></p>
</div>
</p>
</div>
</div>
<div id="structural-annotation" class="section level2">
<h2>Structural annotation</h2>
<span style="color:black">
<p class="text-justify">
In this step, we will use <strong><a
href="https://github.com/Gaius-Augustus/BRAKER">BRAKER3</a></strong> to
structurally annotate the assembled genome with RNA-Seq data and
information from proteins of any evolutionary distance (see
<strong>Figure 10</strong>).
</p>
<img src="Fig_10.svg" style="width: 100%; height: auto; border: 1px solid #ddd; border-radius: 10px;">
<span style="color:black">
<p class="text-center">
<strong>Figure 10</strong>. A simplified scheme of
<strong>BRAKER3</strong> pipeline with RNA and protein evidence.
</p>
<span style="color:black">
<p class="text-justify">
<p>First, we need to prepare the headers of the masked genome by
retaining only the contig names:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code50')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code50" class="code-text">
<pre>sed -i 's/ start.*//' Final_genome_with_Reference.fa.masked</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>sed</code></span> Editor used for text
processing and manipulation<br/> <span
style="color: blue;"><code>-i</code></span> Edits the file in place (the
changes are applied directly to the file)<br/> <span
style="color: blue;"><code>'s/ start.*//'</code></span> Substitutes
words matching <strong>start</strong> following by any characters with
nothing<br/> <span
style="color: blue;"><code>Final_genome_with_Reference.fa.masked</code></span>
The input file to be modified<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
<p>Next, we need to download the latest protein evidence for green algae
and land plants compatible with <strong>Braker3</strong>:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code51')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code51" class="code-text">
<pre>wget https://bioinf.uni-greifswald.de/bioinf/partitioned_odb12/Viridiplantae.fa.gz && \
gzip -d Viridiplantae.fa.gz</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>wget</code></span> Utility to download files
from the web<br/> <span style="color: blue;"><code>gzip -d</code></span>
Decompresses the downloaded file<br/> <span
style="color: blue;"><code>Viridiplantae.fa.gz</code></span> The final
uncompressed file<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
<p>Additionally, we need to index the masked genome:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code52')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code52" class="code-text">
<pre>hisat2-build Final_genome_with_Reference.fa.masked hisat2_masked_genome</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>hisat2-build</code></span> Creates an index
for the reference genome for fast and accurate alignment of sequencing
reads<br/> <span
style="color: blue;"><code>Final_genome_with_Reference.fa.masked</code></span>
The input genome file<br/> <span
style="color: blue;"><code>hisat2_masked_genome</code></span> Specifies
the base name for the output index files<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
<p>Then, we will map the RNA reads to the masked genome:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code53')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code53" class="code-text">
<pre>for sample in SRR3581706 SRR3581708 SRR3581693 SRR3581681 SRR3581356 SRR3581705 SRR3581703; do
    hisat2 -p 12 -x hisat2_masked_genome --rna-strandness F -U "${sample}_RNA_Illumina_chr4_subset.fastq" -S "${sample}.sam"
done</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>for sample in ...; do ... done</code></span>
A loop in Bash for a list of samples (SRR3581706, SRR3581708 ..)<br/>
<span style="color: blue;"><code>hisat2</code></span> Aligns reads to a
reference genome<br/> <span
style="color: blue;"><code>-p 12</code></span> Specifies the number of
threads (CPU cores) to use for parallel processing<br/> <span
style="color: blue;"><code>-x hisat2_masked_genome</code></span>
Specifies the base name of the <strong>HISAT2</strong> index files<br/>
<span style="color: blue;"><code>--rna-strandness F</code></span>
Specifies the strandedness of the RNA-Seq data<br/> <span
style="color: blue;"><code>-U</code></span> Specifies the input FASTQ
file containing single-end RNA-Seq reads<br/> <span
style="color: blue;"><code>${sample}</code></span> Will be replaced with
the current sample ID in each iteration of the loop<br/> <span
style="color: blue;"><code>-S "${sample}.sam"</code></span> Specifies
the output SAM file<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
<p>Now, we will convert the .sam files into the .bam format:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code54')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code54" class="code-text">
<pre>for sample in SRR3581706 SRR3581708 SRR3581693 SRR3581681 SRR3581356 SRR3581705 SRR3581703; do
    samtools view --threads 16 -b -F 4 "${sample}.sam" > "${sample}.bam"
done</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>samtools view</code></span> Reads the input
SAM file<br/> <span
style="color: blue;"><code>--threads 16</code></span> Specifies the
number of threads (CPU cores) to use<br/> <span
style="color: blue;"><code>-b</code></span> Converts SAM to BAM<br/>
<span style="color: blue;"><code>-F 4</code></span> Excludes unmapped
reads<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
<p>And subsequently sort these .bam files:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code55')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code55" class="code-text">
<pre>for sample in SRR3581706 SRR3581708 SRR3581693 SRR3581681 SRR3581356 SRR3581705 SRR3581703; do
  samtools sort -@ 4 -m 10G "${sample}.bam" -o "${sample}_sorted.bam"
done</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>samtools sort</code></span> Sorts alignments
in a BAM file by genomic coordinates<br/> <span
style="color: blue;"><code>-@ 4</code></span> Specifies the number of
threads (CPU cores) to use<br/> <span
style="color: blue;"><code>-m 10G</code></span> Specifies the maximum
memory per thread for sorting<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
<p>It is time to run <strong>Braker3</strong>:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code56')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code56" class="code-text">
<pre>nohup braker.pl --species=A.thaliana \
--genome=Final_genome_with_Reference.fa.masked \
--prot_seq=Viridiplantae.fa \
--bam=SRR3581706_sorted.bam,SRR3581708_sorted.bam,SRR3581693_sorted.bam,SRR3581681_sorted.bam,SRR3581356_sorted.bam,SRR3581705_sorted.bam,SRR3581703_sorted.bam, \
--threads=44 \
--gff3 &</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>nohup</code></span> Runs the command in the
background<br/> <span style="color: blue;"><code>braker.pl</code></span>
Runs BRAKER (a gene prediction pipeline)<br/> <span
style="color: blue;"><code>--species=A.thaliana</code></span> Specifies
the species name for which gene predictions are being generated<br/>
<span
style="color: blue;"><code>--genome=Final_genome_with_Reference.fa.masked</code></span>
Specifies the input genome file<br/> <span
style="color: blue;"><code>--prot_seq=Viridiplantae.fa</code></span>
Specifies a FASTA file containing protein sequences<br/> <span
style="color: blue;"><code>--bam=SRR3581706_sorted.bam...</code></span>
Specifies a comma-separated list of sorted BAM files containing RNA-Seq
alignments<br/> <span
style="color: blue;"><code>--threads=44</code></span> Specifies the
number of threads (CPU cores) to use<br/> <span
style="color: blue;"><code>--gff3</code></span> Requests output in
<strong>GFF3</strong> format<br/> <span
style="color: blue;"><code>&amp;</code></span> Runs the command in the
background (allows you to continue using the terminal while BRAKER
executes)<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
<p>After, we need to collect some statistics on the resulted
annotation:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code57')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code57" class="code-text">
<pre>agat_sp_statistics.pl --gff braker.gff3 -o AraTha_AGAT_stats</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>agat_sp_statistics.pl</code></span> Computes
various statistics about the genome annotation<br/> <span
style="color: blue;"><code>--gff</code></span> Specifies the input GFF3
file containing the genome annotation<br/> <span
style="color: blue;"><code>braker.gff3</code></span> Runs BRAKER (a gene
prediction pipeline)<br/> <span
style="color: blue;"><code>-o AraTha_AGAT_stats</code></span> Specifies
the output file<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
Let’s check the result:
</p>
<div class="alert alert-success"
style="border-radius: 10px; padding: 10px;">
<pre style="color: black; background: transparent; border: none; margin: 0px 10px; padding: 0;">
--------------------------------------------------------------------------------

Compute mrna with isoforms if any

Number of gene                               4252
Number of mrna                               4771
Number of cds                                4771
Number of exon                               24223
Number of intron                             19452
Number of start_codon                        4757
Number of stop_codon                         4769
Number of exon in cds                        24223
Number of intron in cds                      19452
Number of intron in exon                     19452
Number of intron in intron                   16034
Number gene overlapping                      38
Number of single exon gene                   1240
Number of single exon mrna                   1353
mean mrnas per gene                          1.1
mean cdss per mrna                           1.0
mean exons per mrna                          5.1
mean introns per mrna                        4.1
mean start_codons per mrna                   1.0
mean stop_codons per mrna                    1.0
mean exons per cds                           5.1
mean introns in cdss per mrna                4.1
mean introns in exons per mrna               4.1
mean introns in introns per mrna             3.4
Total gene length                            7678231
Total mrna length                            8842281
Total cds length                             5807925
Total exon length                            5807925
Total intron length                          3034356
Total start_codon length                     14267
Total stop_codon length                      14307
Total intron length per cds                  3034356
Total intron length per exon                 3034356
Total intron length per intron               2683871
....................................................
--------------------------------------------------------------------------------
</pre>
</div>
<span style="color:black">
<p class="text-justify">
<p>For the downstream quality check with <strong>BUSCO</strong>, we will
retain only the longest isoforms:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code58')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code58" class="code-text">
<pre>agat_sp_keep_longest_isoform.pl \
   -gff braker.gff3 \
   -o longest_isoform_only.gff3</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>agat_sp_keep_longest_isoform.pl</code></span>
Identifies and retains only the longest transcripts for each gene<br/>
<span style="color: blue;"><code>-gff braker.gff3</code></span>
Specifies the input GFF3 file<br/> <span
style="color: blue;"><code>-o longest_isoform_only.gff3</code></span>
Specifies the output file name<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
<p>And extract these protein sequences from the masked
genome:</span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code59')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code59" class="code-text">
<pre>agat_sp_extract_sequences.pl \
   --gff longest_isoform_only.gff3 \
   -f Final_genome_with_Reference.fa.masked \
   -p \
   -o longest_isoform_only.fa
</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>agat_sp_extract_sequences.pl</code></span>
Extract sequences based on annotations in a GFF3 file<br/> <span
style="color: blue;"><code>--gff longest_isoform_only.gff3</code></span>
Specifies the input<br/> <span
style="color: blue;"><code>-f Final_genome_with_Reference.fa.masked</code></span>
Specifies the input genome<br/> <span
style="color: blue;"><code>-p</code></span> Requests extraction of
protein sequences instead of nucleotide sequences<br/> <span
style="color: blue;"><code>-o longest_isoform_only.fa</code></span>
Specifies the output file<br/> </font></p>
</div>
</div>
</div>
<div id="v-quality-assessment" class="section level1">
<h1>[V] Quality assessment</h1>
<div id="busco" class="section level2">
<h2>BUSCO</h2>
<span style="color:black">
<p class="text-justify">
To assess genome assembly and annotation completeness, we will use
Benchmarking Universal Single-Copy Orthologs (<strong><a
href="https://busco.ezlab.org/">BUSCO</a></strong>). Specifically, we
will compare (1) the original genome assembly versus the one assembled
here and (2) the predicted number of BUSCOs in the assembled genome
versus the number of detected proteins with <strong>BRAKER</strong>.
</p>
<span style="color:black">
<p class="text-justify">
Let’s first check the reference Chromosome 4:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code60')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code60" class="code-text">
<pre>busco \
   -m genome \
   -i Arabidopsis_GWHBDNP00000000_chr4.fasta \
   -o Embryophyta_1614_Ref_Genome \
   -l embryophyta_odb10 \
   --offline \
   --download_path busco_downloads \
   -c 22</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>busco</code></span> Evaluates the
completeness of genome assemblies,<br/> <span
style="color: blue;"><code>-m genome</code></span> Specifies the mode of
operation<br/> <span
style="color: blue;"><code>-i Arabidopsis_GWHBDNP00000000_chr4.fasta</code></span>
The input file<br/> <span
style="color: blue;"><code>-o Embryophyta_1614_Ref_Genome</code></span>
Specifies the output file<br/> <span
style="color: blue;"><code>-l embryophyta_odb10</code></span> Specifies
the lineage dataset to use<br/> <span
style="color: blue;"><code>--offline</code></span> Enables offline mode
(BUSCO uses pre-downloaded datasets)<br/> <span
style="color: blue;"><code>--download_path busco_downloads</code></span>
Specifies the directory where BUSCO datasets are stored<br/> <span
style="color: blue;"><code>-c 22</code></span> Specifies the number of
CPU threads to use<br/> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
And our <em>de novo</em> assembled Chromosome 4:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code61')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code61" class="code-text">
<pre>busco \
   -m genome \
   -i Final_genome_with_Reference.fa.masked \
   -o Embryophyta_1614_Workshop_Genome \
   -l embryophyta_odb10 \
   --offline \
   --download_path busco_downloads \
   -c 22</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
Lastly, we will assess BUSCOs with the pre-computed protein sequences:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code62')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code62" class="code-text">
<pre>busco \
   -m protein \
   -i longest_isoform_only.fa \
   -o Embryophyta_Workshop_Protein_1614 \
   -l embryophyta_odb10 \
   --offline \
   --download_path busco_downloads \
   -c 44
</pre>
</div>
</div>
</p>
<div class="alert alert-info"
style="display: flex; border-radius: 10px;">
<p><span style="color:black;"> Please note that you can also run
<strong>BUSCO</strong> online using the web-based platform <strong><a
href="https://usegalaxy.eu/?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fiuc%2Fbusco%2Fbusco%2F5.8.0%2Bgalaxy0&amp;version=5.8.0%20galaxy0">Galaxy</a></strong>.
</span></p>
</div>
<span style="color:black">
<p class="text-justify">
Time to check the results (<strong>Figure 11</strong>):
</p>
<div style="width: 100%; overflow: hidden; margin: 0; padding: 0;">
<div style="&#10;      transform: scale(0.85);&#10;      transform-origin: 0 0;&#10;      width: 977px;        &#10;      height: 800px;&#10;      margin-top: -50px;&#10;      margin-bottom: -200px;&#10;    ">
<iframe title="BUSCO" src="E:/Work_place_XTBG_China/Tutorial_XTBG_2025/Tutorial/Genome_Assembly_XTBG_2025/Fig_11_BUSCO.html" style="&#10;        border: none;&#10;        outline: none;&#10;        border-radius: 10px;&#10;        width: 100%;&#10;        height: 100%;&#10;      "></iframe>
</div>
</div>
<span style="color:black">
<p class="text-center">
<strong>Figure 11</strong>. BUSCO assessment results across the three
datasets (Chromosome 4).
</p>
</p>
<div class="alert alert-danger"
style="border-radius: 10px; padding: 15px; margin: 20px 0;">
<p><span style="color: black; text-align: justify; display: block;">
<strong>IMPORTANT!</strong> <strong>BUSCO</strong> has several
algorithms that can potentially lead to different assessments of genome
completeness [genome mode]. (1) Miniprot yields slightly higher
completeness scores compared to Augustus and MetaEuk, making it a good
choice for large genomes or when runtime is critical; (2) MetaEuk is
very fast, especially for smaller genomes like fungi, though it may be
slower than Miniprot for larger genomes; (3) Augustus is slower than
both Miniprot and MetaEuk but is recommended when precise gene
predictions are needed and you have time to optimise parameters.
Additionally, the protein mode is standardised, there are no alternative
tools (e.g., Miniprot vs. MetaEuk).</p>
</div>
<p></span></p>
</div>
<div id="quast" class="section level2">
<h2>QUAST</h2>
<span style="color:black">
<p class="text-justify">
Next, to gather additional statistics on our assembly, we will use the
<strong><a href="http://quast.sourceforge.net/docs/manual.html">QUality
ASsessment Tool (QUAST)</a></strong>:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code63')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code63" class="code-text">
<pre>quast.py \
Final_genome_with_Reference.fa.masked \
-r Arabidopsis_GWHBDNP00000000_chr4.fasta \
--min-alignment 20000 \
--extensive-mis-size 500000 \
--min-identity 90 \
--threads 44</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>quast.py</code></span> Assesses the quality
of genome assemblies<br/> <span
style="color: blue;"><code>Final_genome_with_Reference.fa.masked</code></span>
Specifies the input genome<br/> <span
style="color: blue;"><code>-r Arabidopsis_GWHBDNP00000000_chr4.fasta</code></span>
Specifies the reference genome<br/> <span
style="color: blue;"><code>--min-alignment 20000</code></span> Specifies
the min alignment length required for alignments between assembly and
reference<br/> <span
style="color: blue;"><code>--extensive-mis-size 500000</code></span>
Specifies the threshold for classifying large misassemblies<br/> <span
style="color: blue;"><code>--min-identity 90</code></span> Specifies the
min sequence identity required for alignments between assembly and
reference<br/> <span
style="color: blue;"><code>--threads 44</code></span> Specifies the
number of CPU threads to use<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
Let’s see the results (<strong>Figure 12</strong>):
</p>
<div style="width: 100%; overflow: hidden; margin: 0; padding: 0;">
<div style="&#10;      transform: scale(0.85);&#10;      transform-origin: 0 0;&#10;      width: 977px;        &#10;      height: 800px;&#10;      margin-bottom: -200px;&#10;    ">
<iframe title="QUAST" src="E:/Work_place_XTBG_China/Tutorial_XTBG_2025/Tutorial/Genome_Assembly_XTBG_2025/QUAST/icarus_viewers/contig_size_viewer.html" style="&#10;        border: none;&#10;        outline: none;&#10;        border-radius: 10px;&#10;        width: 100%;&#10;        height: 100%;&#10;      "></iframe>
</div>
</div>
<span style="color:black">
<p class="text-center">
<strong>Figure 12</strong>. Quality assessment statistics generated by
<strong>QUAST</strong>.
</p>
</p>
</div>
<div id="dot-plot" class="section level2">
<h2>Dot plot</h2>
<span style="color:black">
<p class="text-justify">
Here, we can also use a dot plot (<strong>Figure 9 = Figure 13</strong>)
to provide an intuitive, global view of how an assembled genome aligns
to a reference (if available). Tools like <strong>QUAST</strong> or
<strong>BUSCO</strong> offer quantitative metrics (e.g., N50,
misassemblies, completeness), but dot plots add qualitative context. For
instance, a dot plot can confirm that a genome is correctly ordered and
oriented, even if <strong>QUAST</strong> flags minor
misassemblies.</span>
</p>
<div style="width: 100%; overflow: hidden; margin: 0; padding: 0;">
<div style="&#10;      transform: scale(0.85);&#10;      transform-origin: 0 0;&#10;      width: 977px;        &#10;      height: 800px;       &#10;      margin-bottom: -100px;&#10;    ">
<iframe title="NP_Dgenies_Chr4" src="E:/Work_place_XTBG_China/Tutorial_XTBG_2025/Tutorial/Genome_Assembly_XTBG_2025/Fig_9_NP_Dgenies_Chr4_vs_GWHBDNP00000000.html" style="&#10;        border: none;&#10;        outline: none;&#10;        border-radius: 10px;&#10;        width: 100%;&#10;        height: 100%;&#10;      "></iframe>
</div>
</div>
<span style="color:black">
<p class="text-center">
<strong>Figure 13</strong>. Dot plot produced by D-Genies: Reference
versus the genome assembled in this tutorial.
</p>
</p>
</div>
<div id="synteny" class="section level2">
<h2>Synteny</h2>
<span style="color:black">
<p class="text-justify">
Another way to verify if our assembly is correctly ordered and oriented
is by comparing the gene order (<strong>Figure 14</strong>) in the newly
assembled genome with the reference. This comparison helps evaluate
large-scale structural accuracy. Additionally, syntenic plots are
commonly used in comparative genomics to highlight similarities and
differences between genomes of interest.
</p>
<img src="Fig_14_Collinearity.svg" style="width: 100%; height: auto; border: 1px solid #ddd; border-radius: 10px;">
<span style="color:black">
<p class="text-center">
<strong>Figure 14</strong>. A visual explanation of the terms
collinearity and synteny.
</p>
</p>
<span style="color:black">
<p class="text-justify">
Here, we will compare the whole genomes of <strong><em><a
href="https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_000001735.4/">Arabidopsis
thaliana</a></em></strong> and <strong><em><a
href="https://www.ncbi.nlm.nih.gov/datasets/genome/GCA_905216605.1/">Arabidopsis
arenosa</a></em></strong>. First, we will download their nucleotide
sequences and annotated genomes:</span>
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code64')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code64" class="code-text">
<pre>
wget https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/905/216/605/GCA_905216605.1_AARE701a/GCA_905216605.1_AARE701a_genomic.gff.gz && pigz -d GCA_905216605.1_AARE701a_genomic.gff.gz && \
wget https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/905/216/605/GCA_905216605.1_AARE701a/GCA_905216605.1_AARE701a_genomic.fna.gz && pigz -d GCA_905216605.1_AARE701a_genomic.fna.gz && \
wget https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/735/GCF_000001735.4_TAIR10.1/GCF_000001735.4_TAIR10.1_genomic.gff.gz && pigz -d GCF_000001735.4_TAIR10.1_genomic.gff.gz && \
wget https://ftp.ncbi.nlm.nih.gov/genomes/all/GCF/000/001/735/GCF_000001735.4_TAIR10.1/GCF_000001735.4_TAIR10.1_genomic.fna.gz && pigz -d GCF_000001735.4_TAIR10.1_genomic.fna.gz</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
We will keep only the longest isoforms:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code65')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code65" class="code-text">
<pre>
agat_sp_keep_longest_isoform.pl -gff GCA_905216605.1_AARE701a_genomic.gff \
-o AraAre_longest_isoform_only.gff3 \
&& \
agat_sp_keep_longest_isoform.pl -gff GCF_000001735.4_TAIR10.1_genomic.gff \
-o AraTha_longest_isoform_only.gff3</pre>
</div>
</div>
</p>
<div class="alert alert-danger"
style="border-radius: 10px; padding: 15px; margin: 20px 0;">
<span style="color: black; text-align: justify; display: block;">
<strong>IMPORTANT!</strong> I had to remove some entries from
<code>AraTha_longest_isoform_only.gff3</code> that were causing errors
in the next steps:
</div>
<p></span></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code66')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code66" class="code-text">
<pre>
grep -v -E '(ID|Parent)=(agat-gene-351|rna-DA397_mgp37)(;|$)' \
AraTha_longest_isoform_only.gff3 > AraTha_longest_isoform_only_corrected.gff3 \
&& \
awk 'NR==FNR { len[$1]=$2; next } $1 in len && ($4 > len[$1] || $5 > len[$1]) { print "Invalid:" $0 }' \
GCF_000001735.4_TAIR10.1_genomic.fna.fai AraTha_longest_isoform_only_corrected.gff3</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
We also need to create index files to enable efficient access to
specific regions of the genomes in subsequent steps:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code67')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code67" class="code-text">
<pre>
samtools faidx GCF_000001735.4_TAIR10.1_genomic.fna \
&& \
samtools faidx GCA_905216605.1_AARE701a_genomic.fna</pre>
</div>
</div>
</p>
<span style="color:black">
<p class="text-justify">
Next, we need to get the transcript sequences:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code68')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code68" class="code-text">
<pre>
gffread -g GCA_905216605.1_AARE701a_genomic.fna \
-w AraAre_transcripts.fa AraAre_longest_isoform_only.gff3 \
&& \   
gffread -g GCF_000001735.4_TAIR10.1_genomic.fna \
-w AraTha_transcripts.fa AraTha_longest_isoform_only_corrected.gff3</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>gffread</code></span> Calls the tool for
processing GFF/GTF files<br/> <span
style="color: blue;"><code>-g GCA_905216605.1_AARE701a_genomic.fna</code></span>
Specifies the input genome<br/> <span
style="color: blue;"><code>-w AraAre_transcripts.fa AraAre_longest_isoform_only.gff3</code></span>
Requests extraction of transcript sequences in FASTA format<br/> </span>
</font></p>
</div>
<span style="color:black">
<p class="text-justify">
Here, we will convert GFF3 into a simpler format used for genomic
annotations (Browser Extensible Data or BED):
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code69')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code69" class="code-text">
<pre>
python -m jcvi.formats.gff bed --type=mRNA --key=ID AraAre_longest_isoform_only.gff3 \
-o AraAre.bed \
&& \
python -m jcvi.formats.gff bed --type=mRNA --key=ID AraTha_longest_isoform_only_corrected.gff3 -o AraTha.bed</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>python</code></span> Invokes the Python
interpreter<br/> <span style="color: blue;"><code>-m</code></span>
Specifies a jcvi module<br/> <span
style="color: blue;"><code>jcvi.formats.gff bed</code></span> Converts a
GFF3 file into BED format<br/> <span
style="color: blue;"><code>--type=mRNA</code></span> Specifies the
feature type to extract from the GFF3 file (mRNA here)<br/> <span
style="color: blue;"><code>---key=ID</code></span> Specifies the
attribute to use as the name for each BED entry<br/> <span
style="color: blue;"><code>AraAre_longest_isoform_only.gff3</code></span>
The input file<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
Subsequently, we need to retrieve the coding sequences (CDS) from the
transcripts:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code70')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code70" class="code-text">
<pre>
python -m jcvi.formats.fasta format AraTha_transcripts.fa AraTha.cds \
&& \
python -m jcvi.formats.fasta format AraAre_transcripts.fa AraAre.cds</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>jcvi.formats.fasta format</code></span>
Processes and reformates a FASTA file by extracting CDS<br/> <span
style="color: blue;"><code>AraTha_transcripts.fa</code></span> Specifies
the input file<br/> <span
style="color: blue;"><code>AraTha.cds</code></span> Specifies the output
file<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
Next, we will perform a pairwise synteny search:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code71')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code71" class="code-text">
<pre>
python -m jcvi.compara.catalog ortholog AraTha AraAre --no_strip_names</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>jcvi.compara.catalog ortholog</code></span>
Identifies orthologous gene pairs between two species based on their
genome annotations<br/> <span
style="color: blue;"><code>AraTha AraAre</code></span> The pair of
species being compared<br/> <span
style="color: blue;"><code>--no_strip_names</code></span> Preserves the
original names in the output<br/> </span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
Here, we need to perform a filtering step on synteny anchors to refine
the results of the synteny analysis:
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code72')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code72" class="code-text">
<pre>
python -m jcvi.compara.synteny screen --simple --minspan=30 AraTha.AraAre.anchors AraTha.AraAre.anchors.anchors.new</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>jcvi.compara.synteny screen</code></span>
Filters and refines orthologous gene pairs based on user-defined
criteria<br/> <span style="color: blue;"><code>--simple</code></span>
Simplifies the filtering process by focusing only on basic criteria<br/>
<span style="color: blue;"><code>--minspan=30</code></span> Specifies
the minimum number of anchor pairs required for a synteny block to be
retained<br/> <span
style="color: blue;"><code>AraTha.AraAre.anchors</code></span> The input
file containing the initial set of orthologous gene pairs between the
species<br/> <span
style="color: blue;"><code>AraTha.AraAre.anchors.anchors.new</code></span>
Preserves the original names in the output<br/></p>
<p></span> </font></p>
</div>
<span style="color:black">
<p class="text-justify">
Additionally, we need to create two files. On is <code>seqids</code>
containing chromosome names of our two genomes:
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><font size="2"> <span style="color:black">
LR999451.1,LR999452.1,LR999453.1,LR999454.1,LR999455.1,LR999456.1,LR999457.1,LR999458.1<br/>
NC_003070.9,NC_003071.7,NC_003074.8,NC_003075.7,NC_003076.8<br/> </span>
</font></p>
</div>
</p>
<span style="color:black">
<p class="text-justify">
The second one is <code>layout</code>, describing how we want our data
to be rendered:
</p>
<div class="alert alert-success"
style="border-radius: 10px; padding: 10px;">
<pre style="color: black; background: transparent; border: none; margin: 0px 10px; padding: 0;">
# y, xstart, xend, rotation, color, label, va,  bed
 .6,     .1,    .8,       0,      , AraAre, center, AraAre.bed
 .4,     .1,    .8,       0,      , AraTha, center, AraTha.bed
# edges
e, 0, 1, AraTha.AraAre.anchors.anchors.simple</pre>
</div>
</p>
<span style="color:black">
<p class="text-justify">
Finally, we will plot the results (<strong>Figure 15</strong>):
</p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">
Unix
</div>
<p><button class="copy-button" onclick="copyText('code73')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code73" class="code-text">
<pre>
python -m jcvi.graphics.karyotype seqids layout --chrstyle=roundrect --basepair</pre>
</div>
</div>
</p>
<div class="alert alert-success"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> <span
style="color: blue;"><code>jcvi.graphics.karyotype</code></span> Invokes
the karyotype plotting module from the jcvi library<br/> <span
style="color: blue;"><code>seqids</code></span> A file listing the
chromosome/contig identifiers (e.g., chr1, chr2) to include in the
plot<br/> <span style="color: blue;"><code>layout</code></span> A
configuration file specifying the arrangement of chromosomes in the plot
(e.g., rows, spacing, colors)<br/> <span
style="color: blue;"><code>--chrstyle=roundrect</code></span> Draws
chromosomes as rounded rectangles instead of default rectangles<br/>
<span style="color: blue;"><code>--basepair</code></span> Adds a scale
bar to the plot, labeled in base pairs<br/> </span> </font></p>
</div>
<img src="Fig_15_Karyotype.svg" style="width: 100%; height: auto; border: 1px solid #ddd; border-radius: 10px;">
<span style="color:black">
<p class="text-center">
<strong>Figure 15</strong>. Dot plot (top) and syntenic blocks (bottom)
identified by <strong>jcvi</strong>.
</p>
</p>
<div class="alert alert-info"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> Additionally, please consider using
<strong><a href="https://github.com/UMNKimballLab/Synteny-Tutorial">this
tutorial</a></strong> for more detailed comparative analysis and
visualisation steps. </span></p>
</div>
</p>
</div>
<div id="more" class="section level2">
<h2>More</h2>
<div class="alert alert-info"
style="display: flex; border-radius: 10px;">
<p><span style="color:black"> You may also check <strong><a
href="https://niwdoog.github.io/Genome_Assembly_Long_Reads_Hi-C/#%5BV%5D_Quality_assessment__visualisation">my
previous tutorial</a></strong> on additional tools you can use to assess
the quality of your newly-assembled genomes. </span></p>
</div>
</p>
</div>
</div>
<div id="vi-software-reference" class="section level1">
<h1>[VI] Software reference</h1>
<span style="color:black">
<p class="text-left">
This section lists the software versions used in the Conda environment
to ensure reproducibility and consistency:
</p>
<p><span style="color:black"></p>
<!-- Header Section -->
<div class="code-header">
<div class="header-text">

</div>
<p><button class="copy-button" onclick="copyText('code74')">Copy</button></p>
</div>
<!-- Content Section -->
<div class="code-content">
<div id="code74" class="code-text">
<pre>agat=1.1.0 
braker3=3.0.8
busco=5.8.2
cutadapt=5.0
dgenies=1.5.0
fastqc=0.12.1 
flye=2.9.5
gffread=0.12.7
hisat2=2.2.1 
jcvi=1.4.16
juicer_tools=2.20.00
minimap2=2.28  
nanoplot=1.44.0 
necat=0.0.1_update20200803
nextpolish2=0.2.1 
parallel=20240122
pigz=2.8
porechop=0.2.4
quast=5.3.0
repeatmasker=4.1.5 
repeatmodeler=2.0.4 
samtools=1.21  
seqtk=1.4 
sra-tools=2.9.6
trim-galore=0.6.10
wget=1.21.4</pre>
</div>
</div>
</p>
</div>
<div id="vii-cite" class="section level1">
<h1>[VII] Cite</h1>
<span style="color:black">
<p class="text-left">
Baiakhmetov E. (2025). <em>Quality check and genome assembly using
Illumina, ONT, HiFi, and Hi-C data</em> [Tutorial]. GitHub. <a
href="https://niwdoog.github.io/XYZ"
class="uri">https://niwdoog.github.io/XYZ</a>
</p>
<p><span style="color:black">
<a href="https://doi.org/10.5281/zenodo.XYZ">
<img src="https://zenodo.org/badge/DOI/10.5281/zenodo.7125249.svg" alt="DOI" style="width: 350px; height: auto;"></a></p>
<script>
function copyText(codeId) {
  // Get the specific code block
  const codeBlock = document.getElementById(codeId);
  
  // Remove <p> tags and extra whitespace
  const rawText = codeBlock.textContent;
  const cleanText = rawText
    .replace(/<p>|<\/p>/g, '') // Remove any paragraph tags
    .trim()
    .replace(/\n\s+/g, '\n'); // Clean up extra spaces

  // Copy to clipboard
  navigator.clipboard.writeText(cleanText).then(() => {
    // Find the clicked button
    const buttons = document.querySelectorAll('.copy-button');
    buttons.forEach(button => {
      if (button.getAttribute('onclick').includes(codeId)) {
        button.textContent = "Copied!";
        setTimeout(() => {
          button.textContent = "Copy";
        }, 500);
      }
    });
  });
}
</script>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
